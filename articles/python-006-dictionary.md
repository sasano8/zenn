---
title: "Pythonã®è¾æ›¸æ“ä½œãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ"
emoji: "ğŸ˜¸" # ã‚¢ã‚¤ã‚­ãƒ£ãƒƒãƒã¨ã—ã¦ä½¿ã‚ã‚Œã‚‹çµµæ–‡å­—ï¼ˆ1æ–‡å­—ã ã‘ï¼‰
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢è¨˜äº‹
topics: ["python"]
published: true
---

# æ¦‚è¦
â€»æœ¬è¨˜äº‹ã¯ã€éšæ™‚åŸ·ç­†ä¸­ã§ã™ã€‚

æœ¬è¨˜äº‹ã§ã¯ã€**ä¸€èˆ¬çš„ãªè¾æ›¸æ“ä½œã¨ãã‚Œã‚‰ã®ç´°ã‹ã„æŒ™å‹•ã«å¿œã˜ãŸä½¿ã„åˆ†ã‘**ã‚’ç´¹ä»‹ã—ã¦ã„ã¾ã™ã€‚
ã•ã‚‰ã«ã€è¾æ›¸ã¨ã„ã†è¦³ç‚¹ã§é–¢é€£ã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚‚æ¨ªæ–­çš„ã«ç´¹ä»‹ã—ã¦ãŠã‚Šã€è¾æ›¸ã‚’ã†ã¾ãæ´»ç”¨ã—ãŸç§»æ¤æ€§é«˜ã„å …ç‰¢ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’çµ„ã‚€ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’ç´¹ä»‹ã—ã¦ã„ã¾ã™ã€‚

æœ¬è¨˜äº‹[ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ](#ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ)ã®ã‚ˆã†ãªè¦æ±‚æ“ä½œã«å¯¾ã™ã‚‹å®Ÿè£…ä¾‹ã‚’ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆã«ä¿¯ç°ã§ãã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒæ¬²ã—ã‹ã£ãŸã®ã§ã™ãŒã€ç”»é¢å¹…ã®éƒ½åˆã§è©³ç´°ãŒä¼ã‚ã‚Šãã‚‰ãªã„ãŸã‚ã€ã²ã¨ã¨ãŠã‚ŠåŸ·ç­†ã™ã‚‹ãƒãƒ¡ã«ãªã‚Šã¾ã—ãŸï¼ˆæ±—ï¼‰ã€‚

æœ¬è¨˜äº‹ã‚’ã²ã¨ã¨ãŠã‚ŠãŠèª­ã¿ã„ãŸã ã„ãŸå¾Œã¯ã€ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã¨ã—ã¦[ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ](#ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ)ã‚’æ´»ç”¨ã„ãŸã ã‘ã‚Œã°å¹¸ã„ã§ã™ã€‚

# æ¤œè¨¼ç’°å¢ƒ
- Python3.9.0

# å¯¾è±¡èª­è€…
èª­è€…ã®ãƒ¡ã‚¤ãƒ³ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¯ã€Python3.5ä»¥ä¸Šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ã™ã€‚
æ¤œè¨¼ç’°å¢ƒã¯3.9ã§ã™ãŒã€Python3.5ç³»ä»¥ä¸Šã®äº’æ›æ€§ã¯èª¿æŸ»ãƒ»è€ƒæ…®ã—ã¦ã„ã¾ã™ã€‚

è¾æ›¸ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã—ãŸè§£èª¬ã®ãŸã‚ã€åŸºç¤çš„ãªçŸ¥è­˜ãƒ»å˜èªã«ã¤ã„ã¦ã¯ã€ãã®ä»–ã®è¨˜äº‹ç­‰ã§è£œå®Œãã ã•ã„ã€‚

Pythonä¸­ç´šè€…ä»¥ä¸Šã®æ–¹ã¯ã€ç›®æ¬¡ã¨[ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ](#ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ)ã‚’è¦‹ã¦æ°—ã«ãªã£ãŸç« ã ã‘ãŠèª­ã¿ãã ã•ã„ã€‚

# å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
æœ€æ–°ã®ä»•æ§˜ã‚„ã€ã‚ˆã‚Šæ­£ç¢ºãªä»•æ§˜ã®ç†è§£ã«ã¯ã€å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚‚å‚ç…§ãã ã•ã„ã€‚

https://docs.python.org/ja/3/library/stdtypes.html#dict

# åŸºç¤ç·¨

## è¾æ›¸ã‚’ä½œæˆã™ã‚‹

### `{}`ã§è¾æ›¸ã‚’ä½œæˆã™ã‚‹
è¾æ›¸ãƒªãƒ†ãƒ©ãƒ«`{}`ã§è¾æ›¸ï¼ˆä»¥å¾Œã€`dict`ã¨ã™ã‚‹ï¼‰ã‚’ä½œæˆã§ãã¾ã™ã€‚

æ€§èƒ½é¢ã§ã‚‚å„ªã‚Œã¦ã„ã‚‹ã‚‚ã£ã¨ã‚‚ãƒãƒ”ãƒ¥ãƒ©ãƒ¼ãªæ–¹æ³•ã§ã™ã®ã§ã€åŸºæœ¬çš„ã«ã“ã®æ–¹æ³•ã‚’ä½¿ç”¨ã—ã¾ã—ã‚‡ã†ã€‚
``` Python
dic = {"key": "test"}
```

### ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ã‹ã‚‰`dict`ã‚’ä½œæˆã™ã‚‹
`dict`é–¢æ•°ã§ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ã«å€¤ã‚’æ¸¡ã™ã¨ã€ãã®ã¾ã¾ã‚­ãƒ¼ã¨å€¤ã¨ã—ã¦å®šç¾©ã§ãã¾ã™ã€‚

ãŸã ã—ã€`dict`é–¢æ•°ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€æ¬¡ã®è¨€èªä»•æ§˜ä¸Šã®åˆ¶ç´„ãŒã‚ã‚Šã¾ã™ã€‚

- ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ã«äºˆç´„èªã¯ä½¿ç”¨ã§ãã¾ã›ã‚“
- ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ã«æ•°å€¤ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“

``` Python
dic = dict(key="test")

# ä¾‹å¤–
dic = dict(from=0)
dic = dict(1=0)
# => SyntaxError: invalid syntax
```

### ã‚­ãƒ¼ã¨å€¤ã®ã‚¿ãƒ—ãƒ«ãƒªã‚¹ãƒˆã‹ã‚‰`dict`ã‚’ä½œæˆã™ã‚‹
`dict`é–¢æ•°ã«ã€ã‚­ãƒ¼ã¨å€¤ã®ã‚¿ãƒ—ãƒ«ã‚’è¦ç´ ã¨ã™ã‚‹ãƒªã‚¹ãƒˆã‚’æ¸¡ã™ã¨ã€`dict`ã‚’ä½œæˆã§ãã¾ã™ã€‚

``` Python
dic = dict([("key1", 1), ("key2", 2)])
# => {'key1': '1', 'key2': '2'}
```

### è¾æ›¸å†…åŒ…è¡¨è¨˜ã§`dict`ã‚’ä½œæˆã™ã‚‹
è¾æ›¸å†…åŒ…è¡¨è¨˜ã‚’ç”¨ã„ã‚‹ã¨ã€ã‚¤ãƒ†ãƒ©ãƒ–ãƒ«[^10002]ã®å‡¦ç†çµæœã‹ã‚‰`dict`ã‚’ä½œæˆã§ãã¾ã™ã€‚
`{ã‚­ãƒ¼:å€¤ for å¤‰æ•°å in ã‚¤ãƒ†ãƒ©ãƒ–ãƒ«}`ã®ã‚ˆã†ã«è¨˜è¿°ã—ã¾ã™ã€‚

``` Python
dic = {str(x):x for x in range(5)}
# => {'0': 0, '1': 1, '2': 2, '3': 3, '4': 4}
```

è¾æ›¸å†…åŒ…è¡¨è¨˜ã‚’ã€ãƒªã‚¹ãƒˆå†…åŒ…è¡¨è¨˜ã§æ›¸ãç›´ã™ã¨æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

``` Python
arr = [(str(x), x) for x in range(5)]
dic = dict(arr)
# => {'0': 0, '1': 1, '2': 2, '3': 3, '4': 4}
```

### ã‚­ãƒ¼ã®ãƒªã‚¹ãƒˆã‹ã‚‰`dict`ã‚’ä½œæˆã™ã‚‹

### `fromkeys`
`fromkeys`ã¯ã€ç¬¬1å¼•æ•°ã«ä¸ãˆã‚‰ã‚ŒãŸã‚¤ãƒ†ãƒ©ãƒ–ãƒ«ã‚’ã‚­ãƒ¼ã¨ã™ã‚‹`dict`ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

- ç¬¬1å¼•æ•°ï¼šã€€ã‚­ãƒ¼ã¨ã™ã‚‹ã‚¤ãƒ†ãƒ©ãƒ–ãƒ«
- ç¬¬2å¼•æ•°ï¼šã€€åˆæœŸå€¤ã¨ã™ã‚‹å€¤ã€‚çœç•¥æ™‚ã¯`None`

``` Python
dic = dict.fromkeys(["a", "b"])
# => {'a': None, 'b': None}

dic = dict.fromkeys(["a", "b"], 0)
# => {'a': 0, 'b': 0}
```

æ³¨æ„ç‚¹ã¨ã—ã¦ã€åˆæœŸå€¤ã¨ã™ã‚‹å€¤ã‚’ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ãªå€¤ã«ã—ã¦ã—ã¾ã†ã¨ã€åŒã˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å‚ç…§ã™ã‚‹ãŸã‚ã€æ¬¡ã®ã‚ˆã†ãªå‰¯ä½œç”¨ãŒã‚ã‚Šã¾ã™ã€‚

``` Python
dic = dict.fromkeys(["a", "b"], [])
# => {'a': [], 'b': []}

# "a"ã®ãƒªã‚¹ãƒˆã«ã®ã¿è¿½åŠ ã•ã‚Œã‚‹æƒ³å®šã ãŒã€åŒã˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å‚ç…§ã—ã¦ã„ã‚‹ãŸã‚ã€ã™ã¹ã¦ã«å½±éŸ¿ãŒç”Ÿã˜ã¦ã—ã¾ã†
dic["a"].append(1)
# => {'a': [1], 'b': [1]}
```

è¾æ›¸å†…åŒ…è¡¨è¨˜ã§ä»£æ›¿å¯èƒ½ã§ã™ã®ã§ã€`fromkeys`ã¯å¿˜ã‚Œã¦ã—ã¾ã£ã¦ã‚‚ã‚ˆã„ã§ã—ã‚‡ã†ã€‚

``` Python
dic = {key:[] for key in ["a", "b"]}
# => {'a': [], 'b': []}

dic["a"].append(1)
# => {'a': [1], 'b': []}
```

:::message
- `{}`ã¯`dict`é–¢æ•°ã«æ¯”ã¹ã€æ€§èƒ½ãŒ2å€ä»¥ä¸Šå„ªã‚Œã‚‹
- dicté–¢æ•°ã§ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ã‚’åˆ©ç”¨ã™ã‚‹ã¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ãŒè¦ç´ ï¼ˆæ–‡å­—åˆ—ã‚­ãƒ¼ã¨å€¤ï¼‰ã¨ã—ã¦å®šç¾©ã•ã‚Œã‚‹ã€‚ãŸã ã—ã€ã‚­ãƒ¼ãŒäºˆç´„èªã‚„æ•´æ•°ãªã©ã®å ´åˆã€`SyntaxError`ã¨ãªã‚‹
:::

## è¦ç´ ï¼ˆã‚­ãƒ¼ã¨å€¤ï¼‰ã‚’ç™»éŒ²ã™ã‚‹
ã‚­ãƒ¼ã‚’æŒ‡å®šã—ã€å€¤ã‚’æ¸¡ã™ã“ã¨ã§è¦ç´ ã‚’ç™»éŒ²ã§ãã¾ã™ã€‚
ã™ã§ã«å¯¾è±¡ã‚­ãƒ¼ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ã€å€¤ãŒä¸Šæ›¸ãã•ã‚Œã¾ã™ã€‚

``` Python
dic = {}
dic["key"] = "val"
```

### `__setitem__`
`dic[key] = value`ã¯ã€`dic.__setitem__(key, value)`ã¨ç­‰ä¾¡ã§ã™ã€‚

``` Python
dic = {}
dic.__setitem__("key", "val")
```

### `setdefault`
`setdefault`ã¯ã€ã‚­ãƒ¼ãŒç™»éŒ²ã•ã‚Œã¦ã„ãªã„å ´åˆã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’ç™»éŒ²ã—ãŸã†ãˆã§ã€ã‚­ãƒ¼ã«å¯¾å¿œã™ã‚‹å€¤ã‚’è¿”ã—ã¾ã™ã€‚

- ç¬¬1å¼•æ•°ï¼šã€€ã‚­ãƒ¼
- ç¬¬2å¼•æ•°ï¼šã€€ã‚­ãƒ¼ãŒç™»éŒ²ã•ã‚Œã¦ã„ãªã„å ´åˆã«ç™»éŒ²ã™ã‚‹å€¤ã€‚çœç•¥æ™‚ã¯`None`ã‚’ç™»éŒ²

``` Python
dic = {}
# ã‚­ãƒ¼ãŒå­˜åœ¨ã—ã¦ã„ãªã„ã®ã§ã€æ–°ãŸãªã‚­ãƒ¼ã¨å€¤ãŒç™»éŒ²ã•ã‚Œã¾ã™
val = dic.setdefault('new', 0)
# => 0

# ã™ã§ã«ã‚­ãƒ¼ãŒå­˜åœ¨ã—ã¦ã„ã‚‹ã®ã§ç¬¬ï¼’å¼•æ•°ã¯ç„¡è¦–ã•ã‚Œã¾ã™
val = dic.setdefault('new', 1)
# => 0

# ç¬¬ï¼’å¼•æ•°ã‚’çœç•¥ã™ã‚‹ã¨NoneãŒç™»éŒ²ã•ã‚Œã¾ã™
dic = {}
val = dic.setdefault('new')
# => None
```

## ã‚­ãƒ¼ã«å¯¾å¿œã™ã‚‹å€¤ã‚’å–å¾—ã™ã‚‹
ã‚­ãƒ¼ã«å¯¾å¿œã™ã‚‹å€¤ã‚’å–å¾—ã«ã¯ã€æ¬¡ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚
ã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ã€`KeyError`ãŒç™ºç”Ÿã—ã¾ã™ã€‚

``` Python
dic = {"name": "test"}
val = dic["name"]
```

### `__getitem__`
`dic[key]`ã¯ã€`dic.__getitem__(key)`ã¨ç­‰ä¾¡ã§ã™ã€‚

``` Python
dic = {"name": "test"}
val = dic.__getitem__("name")
```

### `get`
`KeyError`ã‚’ç„¡è¦–ã—ãŸã„å ´åˆã¯ã€`get`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚

`get`ã¯ã€æŒ‡å®šã—ãŸã‚­ãƒ¼ã®å€¤ã‚’è¿”ã—ã¾ã™ã€‚
æŒ‡å®šã—ãŸã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ã€ç¬¬2å¼•æ•°ã®å€¤ã‚’è¿”ã—ã¾ã™ã€‚
- ç¬¬1å¼•æ•°ï¼šã€€ã‚­ãƒ¼
- ç¬¬2å¼•æ•°ï¼šã€€ã‚­ãƒ¼ãŒç™»éŒ²ã•ã‚Œã¦ã„ãªã„å ´åˆã«è¿”ã™å€¤ã€‚çœç•¥æ™‚ã¯`None`ã‚’è¿”ã™

``` Python
# ã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ã€NoneãŒè¿”ã‚‹
val = dic.get("name")

# ã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ã€ç¬¬ï¼’å¼•æ•°ã®å€¤ãŒè¿”ã‚‹
val = dic.get("name", None)
```

### `setdefault`
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã®ç™»éŒ²ã¨å€¤ã®å–å¾—ã‚’åŒæ™‚ã«è¡Œã„ãŸã„å ´åˆã¯ã€`setdefault`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’åˆ©ç”¨ã—ã¾ã—ã‚‡ã†ã€‚

``` Python
# ã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ã€ç¬¬ï¼’å¼•æ•°ã®å€¤ã‚’ç™»éŒ²ã—ãŸä¸Šã§ã€ãã®å€¤ã‚’è¿”ã™
val = dic.setdefault("name", None)
```

## è¦ç´ ã‚’å‰Šé™¤ã™ã‚‹

### `del`
`del`ã¯ã€æŒ‡å®šã—ãŸã‚­ãƒ¼ã‚’å‰Šé™¤ã—ã¾ã™ã€‚
- æŒ‡å®šã—ãŸã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ã€`KeyError`ãŒç™ºç”Ÿã™ã‚‹
- å‰Šé™¤ä»¥å¤–ã®ä½™è¨ˆãªå‡¦ç†ã‚’è¡Œã‚ãªã„ã®ã§æ€§èƒ½ãŒã‚‚ã£ã¨ã‚‚å„ªã‚Œã‚‹

``` Python
del dic["name"]
```

### `pop`
è¦ç´ ã‚’å‰Šé™¤ã™ã‚‹ã¨ã¨ã‚‚ã«ã€å‰Šé™¤ã•ã‚ŒãŸå€¤ã‚’å—ã‘å–ã‚ŠãŸã„æ™‚ã‚„`KeyError`ã‚’ç„¡è¦–ã—ãŸã„å ´åˆã¯ã€`pop`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

`pop`ã¯ã€æŒ‡å®šã—ãŸã‚­ãƒ¼ã‚’å‰Šé™¤ã—ã€å€¤ã‚’è¿”ã—ã¾ã™ã€‚
- ç¬¬1å¼•æ•°ï¼šã€€ã‚­ãƒ¼
- ç¬¬2å¼•æ•°ï¼šã€€ã‚­ãƒ¼ãŒç™»éŒ²ã•ã‚Œã¦ã„ãªã„å ´åˆã«è¿”ã™å€¤ã€‚çœç•¥æ™‚ã¯`KeyError`ãŒç™ºç”Ÿ

``` Python
# ã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ã€KeyErrorãŒç™ºç”Ÿã™ã‚‹
val = dic.pop("name")

# ã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ã€ç¬¬ï¼’å¼•æ•°ã®å€¤ã‚’è¿”ã™
val = dic.pop("a", None)
```

### `popitem`
`popitem`ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€è¦ç´ ã‚’1ã¤å‰Šé™¤ã—ã€ã‚­ãƒ¼ã¨å€¤ã®ã‚¿ãƒ—ãƒ«ã‚’è¿”ã—ã¾ã™ã€‚

- `dict`ã®è¦ç´ ãŒç©ºã®å ´åˆã€`KeyError`ã‚’é€å‡ºã™ã‚‹
- Python3.7ã‹ã‚‰ã€æœ€å¾Œã®è¦ç´ ã‹ã‚‰å‰Šé™¤ã•ã‚Œã‚‹ã“ã¨ãŒä¿è¨¼ã•ã‚ŒãŸ[^1]
- Python3.7æœªæº€ã¯ã€ç„¡ä½œç‚ºãªé †åºã§è¦ç´ ã‚’å‰Šé™¤ã™ã‚‹

``` Python
dic = {"a": 0}
key_value = dic.popitem()
# => ('a', 0)
```

### è¤‡æ•°ã®è¦ç´ ã‚’å‰Šé™¤ã™ã‚‹
è¤‡æ•°ã®è¦ç´ ã‚’å‰Šé™¤ã—ãŸã„å ´åˆã¯ã€æ¬¡ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚
ãªãŠã€`del`ã¯ãƒªã‚¹ãƒˆå†…åŒ…è¡¨è¨˜ã¨ã¨ã‚‚ã«åˆ©ç”¨ã§ãã¾ã›ã‚“ã€‚

``` Python
dic = {"key1": 1, "key2": 2, "key3": 3}
some_keys = ["key1", "key2"]

# æ–¹æ³•ï¼‘
for key in some_keys:
  del dic[key]

# æ–¹æ³•ï¼’(ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹çš„ã«ã¯æ–¹æ³•1ã‚’æ¨å¥¨)
[dic.pop(key, None) for key in some_keys]
```

### ã™ã¹ã¦ã®è¦ç´ ã‚’å‰Šé™¤ã™ã‚‹

### `clear`
ã™ã¹ã¦ã®è¦ç´ ã‚’å‰Šé™¤ã—ã¾ã™ã€‚

``` Python
dic.clear()
# => {}
```

## ã‚­ãƒ¼ã‚’å¤‰æ›´ã™ã‚‹
`pop`ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ç°¡æ½”ã«å®Ÿç¾ã§ãã¾ã™ã€‚

``` Python
# ã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ã€KeyErrorãŒç™ºç”Ÿã™ã‚‹
dic["new"] = dic.pop("old")
```

## è¦ç´ ï¼ˆã‚­ãƒ¼ã‚„å€¤ï¼‰ã‚’åˆ—æŒ™ã™ã‚‹
è¦ç´ ï¼ˆã‚­ãƒ¼ã‚„å€¤ï¼‰ã‚’åˆ—æŒ™ã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚

``` Python
# ã‚­ãƒ¼ã‚’åˆ—æŒ™ã™ã‚‹
for key in dic:
  print(key)

# ã‚­ãƒ¼ã‚’åˆ—æŒ™ã™ã‚‹
for key in dic.keys():
  print(key)

# å€¤ã‚’åˆ—æŒ™ã™ã‚‹
for value in dic.values():
  print(value)

# è¦ç´ ï¼ˆã‚­ãƒ¼ã¨å€¤ã®ã‚¿ãƒ—ãƒ«ï¼‰ã‚’åˆ—æŒ™ã™ã‚‹
for key, value in dic.items():
  print(key, value)

# è¦ç´ ï¼ˆã‚­ãƒ¼ã¨å€¤ã®ã‚¿ãƒ—ãƒ«ï¼‰ã‚’åˆ—æŒ™ã™ã‚‹
# Python2ç³»ã®ã¿
# Python3ç³»ã§ã¯iteritemsã¯itemsã«çµ±åˆã•ã‚Œã¾ã—ãŸã€‚ï¼ˆ2ç³»ã§ã¯iteritemsã®æ€§èƒ½ã¯itemsã‚ˆã‚Šå„ªã‚Œã¦ã„ã¾ã—ãŸã€‚ï¼‰
for key, value in dic.iteritems():
  print(key, value)
```

## ãƒ“ãƒ¥ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã¤ã„ã¦
`dict`ãŒæŒã£ã¦ã„ã‚‹åˆ—æŒ™ç”¨ãƒ¡ã‚½ãƒƒãƒ‰`keys` `values` `items`ã¯ã€ãƒ“ãƒ¥ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã—ã¾ã™ã€‚
ãƒ“ãƒ¥ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã€ä¸»ã«åˆ—æŒ™ã«é–¢ã™ã‚‹æ©Ÿèƒ½ã ã‘æä¾›ã—ã¾ã™ã€‚

``` Python
dic = {"a": 0}
keys = dic.keys()
# => dict_keys(['a'])

values = dic.values()
# => dict_values([0])

items = dic.items()
# => dict_items([('a', 0)])

# ã“ã®ã‚ˆã†ã«åˆ—æŒ™å‡¦ç†ãŒå¯èƒ½
for key, value in items:
  print(key, value)
```

ãƒ“ãƒ¥ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã€ã‚½ãƒ¼ã‚¹ã«è¦ç´ ã‚’è¿½åŠ ã—ãŸå ´åˆã€åŒæœŸçš„ã«å‹•ä½œã—ã¾ã™ã€‚

``` Python
dic = {"a": 0}
items = dic.items()

# ã‚½ãƒ¼ã‚¹ã«è¦ç´ ã‚’è¿½åŠ ãƒ»æ›´æ–°ã—ãŸå ´åˆã¯åŒæœŸçš„ã«å‹•ä½œ
dic["b"] = 0
items
# => dict_items([('a', 0), ('b', 0)])
```

# ã‚³ãƒ”ãƒ¼ç·¨

## ã‚·ãƒ£ãƒ­ãƒ¼ã‚³ãƒ”ãƒ¼ã™ã‚‹
ã‚·ãƒ£ãƒ­ãƒ¼ã‚³ãƒ”ãƒ¼ã®æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

ã„ãã¤ã‹å®Ÿç¾æ–¹æ³•ãŒã‚ã‚Šã¾ã™ãŒã€`copy`ãƒ¡ã‚½ãƒƒãƒ‰ã ã‘è¦šãˆã‚Œã°ã‚ˆã„ã§ã—ã‚‡ã†ã€‚

``` Python
src = {"name": "bob", "age": 20, "nest": {"name": "mary", "age": 30}}

# æ–¹æ³•ï¼‘
dest1 = dict(**src)

# æ–¹æ³•ï¼’
dest2 = dict(src)

# æ–¹æ³•ï¼“
dest3 = src.copy()
```

ã‚·ãƒ£ãƒ­ãƒ¼ã¯æµ…ã„ã‚’æ„å‘³ã—ã€ãƒã‚¹ãƒˆã—ãŸ`dict`ç­‰ã®å€¤ã¯ã‚³ãƒ”ãƒ¼ã•ã‚Œãšã€ãŸã åŒã˜å®Ÿä½“ã‚’å‚ç…§ã™ã‚‹ã ã‘ã§ã™ã€‚
ãã®ãŸã‚ã€æ¬¡ã®ã‚ˆã†ãªå‰¯ä½œç”¨ãŒç”Ÿã˜ã¾ã™ã€‚

``` Python
src = {"name": "bob", "age": 20, "nest": {"name": "mary", "age": 30}}

dest1 = dict(**src)
dest2 = dict(src)
dest3 = src.copy()

# ã‚³ãƒ”ãƒ¼ã—ãŸdictã‚’å¤‰æ›´ã—ãŸã¤ã‚‚ã‚ŠãŒã€ã‚½ãƒ¼ã‚¹ã¾ã§å½±éŸ¿ã‚’å—ã‘ã¦ã—ã¾ã†
dest1["nest"]["age"] = 0
print(src)   # => {"name": "bob", "age": 20, "nest": {"name": "mary", "age": 0}}
print(dest1) # => {"name": "bob", "age": 20, "nest": {"name": "mary", "age": 0}}

dest2["nest"]["age"] = 1
print(src)   # => {"name": "bob", "age": 20, "nest": {"name": "mary", "age": 1}}
print(dest2) # => {"name": "bob", "age": 20, "nest": {"name": "mary", "age": 1}}

dest3["nest"]["age"] = 2
print(src)   # => {"name": "bob", "age": 20, "nest": {"name": "mary", "age": 2}}
print(dest3) # => {"name": "bob", "age": 20, "nest": {"name": "mary", "age": 2}}

print(src)  # => {"name": "bob", "age": 20, "nest": {"name": "mary", "age": 2}}
print(dest1)  # => {"name": "bob", "age": 20, "nest": {"name": "mary", "age": 2}}
print(dest2)  # => {"name": "bob", "age": 20, "nest": {"name": "mary", "age": 2}}
print(dest3)  # => {"name": "bob", "age": 20, "nest": {"name": "mary", "age": 2}}
```

:::message alert
- ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å‹ï¼ˆæ•´æ•°ã‚„æ–‡å­—åˆ—ï¼‰ãªã©å˜ä¸€ã®å€¤ã¯çŠ¶æ…‹ãŒåˆ†é›¢ã•ã‚Œã‚‹ãŒã€ã‚³ãƒ³ãƒ†ãƒŠå‹ï¼ˆ`dict`ã‚„`list`ãªã©ï¼‰ã¯å†…åŒ…ã—ã¦ã„ã‚‹å€¤ãŒå…±æœ‰ã•ã‚Œã¦ã—ã¾ã†ã“ã¨ã«æ³¨æ„
:::

## ãƒ‡ã‚£ãƒ¼ãƒ—ã‚³ãƒ”ãƒ¼ã™ã‚‹
ãƒ‡ã‚£ãƒ¼ãƒ—ã‚³ãƒ”ãƒ¼ã®æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

`copy`ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®`deepcopy`ã§å®Ÿç¾ã§ãã¾ã™ã€‚
ãƒ‡ã‚£ãƒ¼ãƒ—ã‚³ãƒ”ãƒ¼ã¯ã€ãƒã‚¹ãƒˆã•ã‚ŒãŸ`dict`ã‚‚å†å¸°çš„ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚

``` Python
import copy
src = {"name": "bob", "age": 20, "nest": {"name": "mary", "age": 30}}
dest = copy.deepcopy(src)

# çµæœç¢ºèª
dest["nest"]["age"] = 5
print(src)   # => {"name": "bob", "age": 20, "nest": {"name": "mary", "age": 30}}
print(dest) # => {"name": "bob", "age": 20, "nest": {"name": "mary", "age": 5}}
```

## ã‚³ãƒ”ãƒ¼ã®æŒ™å‹•ã‚’å¤‰æ›´ã™ã‚‹
ã‚³ãƒ”ãƒ¼ã®ç‹¬è‡ªå®Ÿè£…ã‚’ã™ã‚‹å ´åˆã¯ã€`__copy__`ï¼ˆã‚·ãƒ£ãƒ­ãƒ¼ã‚³ãƒ”ãƒ¼ç”¨ï¼‰ãƒ¡ã‚½ãƒƒãƒ‰ã¨`__deepcopy__`ï¼ˆãƒ‡ã‚£ãƒ¼ãƒ—ã‚³ãƒ”ãƒ¼ç”¨ï¼‰ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

å®Ÿè£…ä¾‹ã«ã¤ã„ã¦ã¯ã€å‰²æ„›ã—ã¾ã™ã€‚

``` Python
class MyDict(dict):
  def __copy__(self):
    ...
  def __deepcopy__(self, memo):
    ...
```

# ãƒãƒ¼ã‚¸ç·¨
2ã¤ä»¥ä¸Šã®`dict`ã‚’ãƒãƒ¼ã‚¸ã—ã¦ã€1ã¤ã®`dict`ã«ã—ãŸã„å ´åˆã®å®Ÿç¾æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚
æ–¹æ³•ã«ã‚ˆã‚ŠæŒ™å‹•ãŒç•°ãªã‚‹ã®ã§ã€çŠ¶æ³ã«å¿œã˜ã¦ä½¿ã„åˆ†ã‘ã¦ãã ã•ã„ã€‚

## ãƒãƒ¼ã‚¸ã™ã‚‹ï¼ˆè¡çªã™ã‚‹ã‚­ãƒ¼ã®å€¤ã¯ä¸Šæ›¸ãï¼‰
ã‚­ãƒ¼ãŒè¡çªã—ãŸå ´åˆã€å€¤ã‚’ä¸Šæ›¸ãã™ã‚‹ãƒãƒ¼ã‚¸æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ¯ã«ãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ãŒç•°ãªã‚‹ãŸã‚ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã”ã¨ã«ç´¹ä»‹ã—ã¾ã™ã€‚

### Python3.5æœªæº€
`dict`é–¢æ•°ã®ç¬¬1ä½ç½®å¼•æ•°ã«ã‚½ãƒ¼ã‚¹`dict`ã‚’æ¸¡ã—ã€ã‚¢ãƒ³ãƒ‘ãƒƒã‚¯è¨˜æ³•ã‚’ä½µç”¨ã™ã‚‹ã“ã¨ã§ãƒãƒ¼ã‚¸ã•ã‚ŒãŸ`dict`ã‚’ä½œæˆã§ãã¾ã™ã€‚
ã‚½ãƒ¼ã‚¹`dict`ã‚’ç›´æ¥æ›´æ–°ã™ã‚‹å ´åˆã¯ã€`update`ãƒ¡ã‚½ãƒƒãƒ‰ãŒä½¿ç”¨ã§ãã¾ã™ã€‚

``` Python
dic1 = {"name": "bob", "age": 20}
dic2 = {"name": "mary"}

# æ–°ãŸã«dictã‚’ä½œæˆ
dic = dict(dic1, **dic2)
# => {"name": "mary", "age": 20}

# ã‚½ãƒ¼ã‚¹dictã‚’æ›´æ–°
dic1.update(dic2)
# => {"name": "mary", "age": 20}
```

### Python3.5ä»¥ä¸Š
è¾æ›¸ãƒªãƒ†ãƒ©ãƒ«å†…ã«ã€ã‚¢ãƒ³ãƒ‘ãƒƒã‚¯è¨˜æ³•`**`ã‚’ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸ[^2]ã€‚
ãƒ¢ãƒ€ãƒ³ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ã‚ˆãç”¨ã„ã‚‰ã‚Œã¾ã™ã€‚

``` Python
dic1 = {"name": "bob", "age": 20}
dic2 = {"name": "mary"}

# æ–°ãŸã«dictã‚’ä½œæˆ
dic = {**dic1, **dic2}
# => {"name": "mary", "age": 20}

# ã‚½ãƒ¼ã‚¹dictã‚’æ›´æ–°
dic1.update(dic2)
# => {"name": "mary", "age": 20}
```

### Python3.9ä»¥ä¸Š
Python3.9ã‹ã‚‰ã¯ã€å’Œé›†åˆæ¼”ç®—å­`|`ã¨ç´¯ç®—ä»£å…¥æ¼”ç®—å­`|=`ãŒå°å…¥ã•ã‚Œã€ãƒãƒ¼ã‚¸ã™ã‚‹æ„æ€ã‚’ã‚ˆã‚Šæ˜ç¤ºçš„ã«è¡¨ç¾å¯èƒ½ã«ãªã‚Šã¾ã—ãŸ[^5]ã€‚

``` Python
dic1 = {"name": "bob", "age": 20}
dic2 = {"name": "mary"}

# æ–°ãŸã«dictã‚’ä½œæˆ
dic = dic1 | dic2
# => {"name": "mary", "age": 20}

# ã‚½ãƒ¼ã‚¹dictã‚’æ›´æ–°
dic1 |= dic2
# => {"name": "mary", "age": 20}
```

:::message
- Python3.5ä»¥é™ã¯ã€ã‚¢ãƒ³ãƒ‘ãƒƒã‚¯è¨˜æ³•`**`ã‚’ç©æ¥µçš„ã«åˆ©ç”¨ã—ã¾ã—ã‚‡ã†
- Python3.9ä»¥é™ã¯ã€`|`ã¨`|=`ã‚’ç©æ¥µçš„ã«åˆ©ç”¨ã—ã¾ã—ã‚‡ã†
:::

## ãƒãƒ¼ã‚¸ã™ã‚‹ï¼ˆè¡çªã™ã‚‹ã‚­ãƒ¼ã¯è¨±å®¹ã—ãªã„ï¼‰
Pythonã®è¨€èªä»•æ§˜ä¸Šã€é–¢æ•°ã«æ¸¡ã—ãŸã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ãŒè¡çªã™ã‚‹ã¨`TypeError`ãŒç™ºç”Ÿã—ã¾ã™ã€‚

ã“ã®ä»•æ§˜ã‚’åˆ©ç”¨ã—ã¦ã€è¡çªã™ã‚‹ã‚­ãƒ¼ã¯è¨±å®¹ã—ãªã„ãƒãƒ¼ã‚¸ã‚’å®Ÿç¾ã—ã¾ã™ã€‚

``` Python
dic1 = {}
dic2 = {"name": "test"}

dic = dict(**dic1, **dic2)
# => {"name": "test"}

# ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã‚‚å¯èƒ½
dic = dict(key1="val1", key2="val2", **dic2}
# => {"key1": "val1", "key2": "val2", "name": "test"}
```

ã‚­ãƒ¼ãŒè¡çªã—ãŸå ´åˆã¯ã€`TypeError`ãŒç™ºç”Ÿã—ã¾ã™ã€‚

``` Python
dic1 = {"name": "bob", "age": 20}
dic2 = {"name": "mary"}

# ã‚­ãƒ¼ãŒè¡çªã™ã‚‹å ´åˆã¯ãƒãƒ¼ã‚¸ä¸å¯
dic = dict(**dic1, **dic2)
# => TypeError: func() got multiple values for keyword argument 'name'
```

ã“ã®æ–¹æ³•ã¯ã€`dict`é–¢æ•°ã«é™ã£ãŸè©±ã§ãªãã€é–¢æ•°å…¨èˆ¬ã«å¿œç”¨ãŒå¯èƒ½ã§ã™ã€‚

``` Python
dic1 = {}
dic2 = {"name": "test"}

def func(**kwargs):
  pass

func(**dic1, **dic2)
```

é–¢æ•°ãŒå¯å¤‰é•·ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å—ã‘å…¥ã‚Œå¯èƒ½ãªå ´åˆã‚‚ã€é‡è¤‡ã—ãŸã‚­ãƒ¼ãŒæ¸¡ã£ã¦ãã‚‹ã‚ˆã†ãªã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

``` Python
# å¯å¤‰é•·ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ã«ã€é‡è¤‡ã—ã¦ã‚­ãƒ¼ãŒæ¸¡ã£ã¦ãã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã›ã‚“
dic1 = {"name": "bob", "age": 20}
dic2 = {"name": "mary"}

def func(name, age, **kwargs):
  pass

func(**dic1, **dic2)
# => TypeError: func() got multiple values for keyword argument 'name'
```

ã‚­ãƒ¼ã«ç©ºæ–‡å­—ãƒ»è¨˜å·ãƒ»äºˆç´„èªãŒå«ã¾ã‚Œã¦ã„ã¦ã‚‚å•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚

``` Python
dic = {"": 0, "@": 0, "from": 0}
dict(**dic)
# => {'from': 0, '@': 0, '': 0}
```

ãŸã ã—ã€ã“ã®æ–¹æ³•ã§ä½¿ç”¨ã§ãã‚‹ã‚­ãƒ¼ã¯æ–‡å­—åˆ—ã«é™ã‚Šã¾ã™ã€‚

``` Python
dic = {0: 0}
dict(**dic)
# => TypeError: func() keywords must be strings
```

:::message
- ã‚­ãƒ¼ã®è¡çªã‚’æ¤œçŸ¥ã—ãŸã„å ´åˆã¯ã€`dict`é–¢æ•°ã¨ã‚¢ãƒ³ãƒ‘ãƒƒã‚¯è¨˜æ³•`**`ã‚’ä½¿ç”¨ã™ã‚‹
- Python3.5ã‹ã‚‰`dict`ä½œæˆæ™‚ã«è¤‡æ•°ã®ã‚¢ãƒ³ãƒ‘ãƒƒã‚¯è¨˜æ³•`**`ãŒåˆ©ç”¨å¯èƒ½ã«ãªã‚Šã€ãƒãƒ¼ã‚¸ãŒç°¡å˜ã«ãªã£ãŸ
- ã“ã®æ–¹æ³•ã§ä½¿ç”¨ã§ãã‚‹ã‚­ãƒ¼ã¯ã€æ–‡å­—åˆ—ã«é™å®šã•ã‚Œã‚‹
:::

### `{}`ã¨`dict`ã®æ··åŒã«æ³¨æ„
`{}`ã«ã‚ˆã‚‹ãƒãƒ¼ã‚¸ã¨`dict`é–¢æ•°ã«ã‚ˆã‚‹ãƒãƒ¼ã‚¸ã®æŒ™å‹•ã¯ç•°ãªã‚‹ãŸã‚ã€æ··åŒã—ãªã„ã‚ˆã†ã«æ³¨æ„ã—ã¾ã—ã‚‡ã†ã€‚

``` Python
dic1 = {"name": "bob", "age": 20}
dic2 = {"name": "mary"}

dic = {**dic1, **dic2}
# => {"name": "mary", "age": 20}

dic = dict(**dic1, **dic2)
# => TypeError: func() got multiple values for keyword argument 'name'
```

:::message alert
- `{}`ã¨`dict`é–¢æ•°ã®æŒ™å‹•ã‚’ä½¿ã„åˆ†ã‘ã¦ãƒãƒ¼ã‚¸ã—ã¾ã—ã‚‡ã†ã€‚
:::


## ãƒ‡ã‚£ãƒ¼ãƒ—ãƒãƒ¼ã‚¸ï¼ˆãƒã‚¹ãƒˆã—ãŸè¾æ›¸ã‚’ãƒãƒ¼ã‚¸ï¼‰ã™ã‚‹
å‰ç« ã§ç´¹ä»‹ã—ãŸãƒãƒ¼ã‚¸ã¯ã€ãƒã‚¹ãƒˆã•ã‚ŒãŸ`dict`ã©ã†ã—ã®ãƒãƒ¼ã‚¸ã¯è¡Œã£ã¦ãã‚Œã¾ã›ã‚“ã€‚
ä¾‹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

``` Python
dic1 = {"nest": {"name": "bob", "age": 20}}
dic2 = {"nest": {"name": "mary"}}

# æ–¹æ³•ï¼‘
{**dic1, **dic2}
# => {'nest': {'name': 'mary'}}

# æ–¹æ³•ï¼’
dict(dic1, **dic2)
# => {'nest': {'name': 'mary'}}

# æ–¹æ³•ï¼“
dic1 | dic2
# => {'nest': {'name': 'mary'}}

# æ–¹æ³•ï¼”
dic1.update(dic2)
# => {'nest': {'name': 'mary'}}

# æ–¹æ³•ï¼•
dic1 |= dic2
# => {'nest': {'name': 'mary'}}
```

ãƒã‚¹ãƒˆã—ãŸ`dict`ã¯ã€`dict`ã”ã¨ç½®ãæ›ãˆã‚‰ã‚Œã¦ã„ã¾ã™ã€‚
ã“ã“ã§ã¯ã€æ¬¡ã®ã‚ˆã†ã«ãƒã‚¹ãƒˆã—ãŸ`dict`ã‚’å†å¸°çš„ã«ãƒãƒ¼ã‚¸ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

``` Python
a = {"nest": {"name": "bob", "age": 20}}
b = {"nest": {"name": "mary"}}

dic = deep_merge(a, b)
# => {'nest': {"name": "mary", "age": 20}}
```

ãƒ‡ã‚£ãƒ¼ãƒ—ãƒãƒ¼ã‚¸ã¯ã€æ¨™æº–æ©Ÿèƒ½ã¨ã—ã¦ã¯æä¾›ã•ã‚Œã¦ã„ãªã„ãŸã‚ã€é–¢æ•°ã‚’è‡ªä½œã—ãŸã‚Šã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
å‚è€ƒã¾ã§ã«ã€ãƒ‡ã‚£ãƒ¼ãƒ—ãƒãƒ¼ã‚¸ã™ã‚‹ãŸã‚ã®ã‚³ãƒ¼ãƒ‰ä¾‹ã‚’è¼‰ã›ã¦ãŠãã¾ã™ã€‚

``` Python
def deep_merge(dic1, dic2):
  "2ã¤ã®è¾æ›¸ã®åŒä¸€ã‚­ãƒ¼ãŒäº’ã„ã«è¾æ›¸ã®å ´åˆã€å†å¸°çš„ã«ãƒãƒ¼ã‚¸ã™ã‚‹ã€‚ãã‚Œä»¥å¤–ã¯ä¸Šæ›¸ã"
  import copy
  src1 = copy.deepcopy(dic1)
  src2 = copy.deepcopy(dic2)
  return deep_merge_sub(src1, src2)

def deep_merge_sub(dic1, dic2):
  for key in dic2.keys():
    if isinstance(dic2[key], dict) \
    and key in dic1 \
    and isinstance(dic1[key], dict):
      deep_merge_sub(dic1[key], dic2[key])
    else:
      dic1[key] = dic2[key]
  return dic1

a = {"nest": {"name": "bob", "age": 20}}
b = {"nest": {"name": "mary"}}

dic = deep_merge(a, b)
# => {'nest': {"name": "mary", "age": 20}}
```

# å•ã„åˆã‚ã›ç·¨

## ã‚­ãƒ¼ã®å­˜åœ¨ã‚’èª¿ã¹ã‚‹
`in`ã‚’ä½¿ã†ã“ã¨ã§ã€ã‚­ãƒ¼ãŒå­˜åœ¨ã™ã‚‹ã‹èª¿ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
`not`ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€ã‚­ãƒ¼ãŒå­˜åœ¨ã—ã¦ã„ãªã„ã“ã¨ã‚‚èª¿ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

``` Python
dic = {"a": 0}
"a" in dic
# => True

"b" not in dic
# => True

not "b" in dic
# => True
```

## å€¤ã®å­˜åœ¨ã‚’èª¿ã¹ã‚‹
å€¤ã®å­˜åœ¨ã‚’èª¿ã¹ã‚‹å ´åˆã¯ã€`in`ã¨`values`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½µç”¨ã—ã¾ã™ã€‚

``` Python
dic = {"a": 0}
0 in dic.values()
# => True
```

ã‚­ãƒ¼ã«å¯¾ã™ã‚‹`in`ã¯ãƒãƒƒã‚·ãƒ¥æ¢ç´¢ã®ãŸã‚ã‚³ã‚¹ãƒˆãŒå°‘ãªã„ã§ã™ãŒã€å€¤ã«å¯¾ã™ã‚‹`in`ã¯ç·šå½¢æ¢ç´¢ã¨ãªã‚‹ãŸã‚ã‚³ã‚¹ãƒˆãŒå¤§ãã„ã§ã™ã€‚
ä½•åº¦ã‚‚èµ°æŸ»ã™ã‚‹å ´åˆã¯ã€`set`å‹ãªã©ã®ãƒãƒƒã‚·ãƒ¥æ¢ç´¢ã‚’å®Ÿè£…ã—ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½¿ç”¨ã—ã¾ã—ã‚‡ã†ã€‚

``` Python
dic = {"a": 0, "b": 1, "c": 0}
values = set(dic.values())
# => {0, 1}

0 in values
```

## è¤‡æ•°ã®ã‚­ãƒ¼ã®å­˜åœ¨ã‚’èª¿ã¹ã‚‹
è¤‡æ•°ã®ã‚­ãƒ¼ã‚’èª¿ã¹ã‚‹ã«ã¯ã€`all`ï¼ˆã™ã¹ã¦ã®è¦ç´ ãŒTrueã‹åˆ¤å®šï¼‰ã‚„`any`ï¼ˆã„ãšã‚Œã‹ã®è¦ç´ ãŒTrueã‹åˆ¤å®šï¼‰ã¨ã€foræ–‡ã‚„ãƒªã‚¹ãƒˆå†…åŒ…è¡¨è¨˜ãªã©ã¨çµ„ã¿åˆã‚ã›ã¦å®Ÿç¾ã—ã¾ã™ã€‚

``` Python
dic = {"a": 0, "b": 0}

all(key in dic for key in {"a", "b"})
# => True

all(key in dic for key in {"a", "c"})
# => False

any(key in dic for key in {"a", "c"})
# => True

any(key in dic for key in {"c", "d"})
# => False
```

ç´¹ä»‹ã—ãŸã‚³ãƒ¼ãƒ‰ã¯ã€ifæ–‡ãªã©ã¨çµ„ã¿åˆã‚ã›ã¦ä½¿ç”¨ãã ã•ã„ã€‚

``` Python
if "a" in dic:
  ...

if all(key in dic for key in {"a", "b"}):
  ...
```

## è¦ç´ ã‚’ãƒ•ã‚£ãƒ«ã‚¿ã™ã‚‹
`dict`ã‹ã‚‰ä»»æ„ã®è¦ç´ ã‚’æŠ½å‡ºã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚

``` Python
dic = {"a": 0, "b": 0}
condition = {"a"}

result = {}
for key, value in dic.items():
  if key in condition:
    result[key] = dic[key]
# => {"a": 0}
```

ãªãŠã€`condition = {"a"}`ã¯`set`ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã—ã¦ã„ã¾ã™ã€‚
`set`ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯ã€ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªãƒªã‚¹ãƒˆï¼ˆå€¤ã‚’æŒãŸãªã„`dict`ã®ã‚ˆã†ãªã‚‚ã®ï¼‰ã§ã€ãƒãƒƒã‚·ãƒ¥æ¢ç´¢ã«ã‚ˆã‚‹é«˜é€Ÿãªæ¤œç´¢ã‚’è¡Œãˆã¾ã™ã€‚

### è¾æ›¸å†…åŒ…è¡¨è¨˜
ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã¯ã€ã‚„ã‚„å†—é•·ã§ã™ã€‚è¾æ›¸å†…åŒ…è¡¨è¨˜ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã‚ˆã‚Šç°¡æ½”ã«ã§ãã¾ã™ã€‚
æ›¸ãæ–¹ãŒç‹¬ç‰¹ã§ã™ãŒã€æ€§èƒ½é¢ã§ã‚‚å„ªé‡ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ç©æ¥µçš„ã«ä½¿ã„ã¾ã—ã‚‡ã†ã€‚

``` Python
dic = {"a": 0, "b": 0}
condition = {"a"}

result = {key:value for key, value in dic.items() if key in condition}
# => {"a": 0}
```

### `filter`
`filter`é–¢æ•°ã¯ã€ç¬¬1å¼•æ•°ã«è©•ä¾¡é–¢æ•°ã€ç¬¬2å¼•æ•°ã«ã‚¤ãƒ†ãƒ©ãƒ–ãƒ«ã‚’å–ã‚Šã¾ã™ã€‚
å„è¦ç´ ã‚’è©•ä¾¡é–¢æ•°ã§è©•ä¾¡ã—ã€`True`ã¨åˆ¤å®šã•ã‚Œã‚‹è¦ç´ ã®ã¿ã‚’æŠ½å‡ºã™ã‚‹ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿[^10001]ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

è©•ä¾¡é–¢æ•°ã¯1ã¤ã®å¼•æ•°ã‚’å–ã‚Šã€ã‚­ãƒ¼ã¨å€¤ã®ã‚¿ãƒ—ãƒ«ã‚’å—ã‘å–ã‚Šã¾ã™ã€‚

``` Python
dic = {"a": 0, "b": 0}
condition = {"a"}

# ã‚­ãƒ¼ãŒ"a"ã®ã¿æŠ½å‡ºã™ã‚‹
result = dict(filter(lambda key_value: key_value[0] in condition, dic.items()))
# => {"a": 0}

# å€¤ãŒ"a"ã®ã¿æŠ½å‡ºã™ã‚‹
result = dict(filter(lambda key_value: key_value[1] in condition, dic.items()))
# => {}
```

## è¦ç´ æ•°ã‚’èª¿ã¹ã‚‹
è¦ç´ æ•°ã‚’èª¿ã¹ã‚‹å ´åˆã¯ã€`len`ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

``` Python
dic = {}
len(dic)
# => 0
```

## é›†è¨ˆã™ã‚‹
è¦ç´ ã‚’é›†è¨ˆã—ãŸã„å ´åˆã¯ã€`Counter`ã‚’åˆ©ç”¨ã§ãã¾ã™ã€‚
è©³ã—ã„ä½¿ã„æ–¹ã«ã¤ã„ã¦ã¯ã€[è¦ç´ ã‚’é›†è¨ˆã—ãŸè¾æ›¸](#è¦ç´ ã‚’é›†è¨ˆã—ãŸè¾æ›¸ã‚’ä½œæˆã™ã‚‹)ã‚’å‚ç…§ãã ã•ã„ã€‚

``` Python
from collections import Counter

dic = {
    "Google": "America",
    "Amazon": "America",
    "Facebook": "America",
    "Apple": "America",
    "Toyota": "Japan"
}

countries = dic.values()
Counter(countries)
# => Counter({'America': 4, 'Japan': 1})
```

# ã‚½ãƒ¼ãƒˆç·¨
`dict`ã‚’ã‚½ãƒ¼ãƒˆã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

## ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®é †åºã«ã¤ã„ã¦
Python3.7ã‹ã‚‰ã¯ã€`dict`ãŒè¿”ã™è¦ç´ ã®é †åºã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

- æŒ¿å…¥é †ã§è¦ç´ ã‚’è¿”ã™[^1]
- è¦ç´ ã®æ›´æ–°ã¯é †åºã«å½±éŸ¿ã‚’ä¸ãˆãªã„

Python3.7æœªæº€ã§æŒ¿å…¥é †åºã‚’ç®¡ç†ã™ã‚‹å ´åˆã¯[`OrderedDict`](#æŒ¿å…¥é †ã‚’ä¿æŒã—ãŸè¾æ›¸ã‚’ä½œæˆã™ã‚‹)ã‚’åˆ©ç”¨ãã ã•ã„ã€‚

## æ•°å€¤ã‚’ã‚½ãƒ¼ãƒˆã™ã‚‹
`sorted`é–¢æ•°ã¯ã€ä»»æ„ã®ã‚­ãƒ¼ã§ã‚½ãƒ¼ãƒˆã•ã‚ŒãŸãƒªã‚¹ãƒˆã‚’è¿”ã—ã¾ã™ã€‚

keyã«ã‚½ãƒ¼ãƒˆç”¨ã®é–¢æ•°ã‚’æ¸¡ã™ã¨ã€ãã®é–¢æ•°ã®æˆ»ã‚Šå€¤ã®å¤§å°ãŒæ˜‡é †ã§ã‚½ãƒ¼ãƒˆã•ã‚Œã¾ã™ã€‚

``` Python
# æ•°å€¤ã§ã‚’ã‚½ãƒ¼ãƒˆã™ã‚‹
dic = {"a": 1, "b": 0, "c": -1}

# å€¤ã‚’æ˜‡é †ã«ã‚½ãƒ¼ãƒˆã—ã€å€¤ã‚’ãƒªã‚¹ãƒˆåŒ–ã™ã‚‹
sorted(dic.values(), key=lambda x: x)
# => [-1, ,0 ,2]

# å€¤ã‚’æ˜‡é †ã«ã‚½ãƒ¼ãƒˆã—ã€å€¤ã‚’ãƒªã‚¹ãƒˆåŒ–ã™ã‚‹ï¼ˆkeyã‚’çœç•¥ã—ãŸå ´åˆã¯ã€æš—é»™çš„ã«åˆ—æŒ™ã•ã‚ŒãŸå€¤ã®å¤§å°ãŒè©•ä¾¡ã•ã‚Œã¾ã™ï¼‰
sorted(dic.values())
# => [-1, ,0 ,2]

# itemsã§ã‚¿ãƒ—ãƒ«ã‚’å—ã‘å–ã‚‹å ´åˆã¯ã€0 - ã‚­ãƒ¼, 1 - å€¤ã€€ã§ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹
# å€¤ã‚’æ˜‡é †ã«ã‚½ãƒ¼ãƒˆã—ã€è¦ç´ ã‚’ãƒªã‚¹ãƒˆåŒ–ã™ã‚‹
sorted(dic.items(), key=lambda x: x[1])
# => [('c', -1), ('b', 0), ('a', 1)]

# å€¤ã‚’é™é †ã«ã‚½ãƒ¼ãƒˆã—ã€è¦ç´ ã‚’ãƒªã‚¹ãƒˆåŒ–ã™ã‚‹
sorted(dic.items(), key=lambda x: -1 * x[1])
# => [('a', 1), ('b', 0), ('c', -1)]

# å€¤ã‚’çµ¶å¯¾å€¤ã‚’æ˜‡é †ã«ã‚½ãƒ¼ãƒˆã—ã€è¦ç´ ã‚’ãƒªã‚¹ãƒˆåŒ–ã™ã‚‹
sorted(dic.items(), key=lambda x: abs(x[1]))
# => [('b', 0), ('a', 1), ('c', -1)]

# ã“ã®ã‚ˆã†ã«ã‚½ãƒ¼ãƒˆã•ã‚ŒãŸã‚­ãƒ¼ã¨å€¤ã‚’å‡¦ç†ã§ãã‚‹
for key, value in sorted(dic.items()):
    print(key, value)
```

## æ–‡å­—åˆ—ã‚’ã‚½ãƒ¼ãƒˆã™ã‚‹
æ–‡å­—åˆ—ã‚‚`sorted`é–¢æ•°ã‚’åˆ©ç”¨ã—ã€åŒæ§˜ã«ã‚½ãƒ¼ãƒˆã§ãã¾ã™ã€‚

æ–‡å­—åˆ—ã«ã¯ãã‚Œãã‚Œæ–‡å­—ã‚³ãƒ¼ãƒ‰ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ãŠã‚Šã€æ–‡å­—ã‚³ãƒ¼ãƒ‰ã«åŸºã¥ã„ãŸè¾æ›¸é †ã¨ãªã‚Šã¾ã™ã€‚
è¾æ›¸é †ã¯ã€å…ˆé ­ã®æ–‡å­—é †ã§ä¸¦ã³ã€2æ–‡å­—ç›®ä»¥é™ã‚‚åŒæ§˜ã«ç¹°ã‚Šè¿”ã—ä¸¦ã³æ›¿ãˆã‚‰ã‚Œã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã«ãªã‚Šã¾ã™ã€‚

ãªãŠã€æ–‡å­—ã‚³ãƒ¼ãƒ‰ã¯ã€`ord`é–¢æ•°ã§ç¢ºèªã§ãã¾ã™ã€‚

``` Python
dic = {"a": "a", "b": "12", "c": "A", "d": "AA", "e": "2", "f": "1"}

# å˜ç´”ã«å€¤ã§ã‚½ãƒ¼ãƒˆ
sorted(dic.items(), key=lambda x: x[1])
# => [('f', '1'), ('b', '12'), ('e', '2'), ('c', 'A'), ('d', 'AA'), ('a', 'a')]

# å¤§å°æ–‡å­—åŒºåˆ¥ãªãã‚½ãƒ¼ãƒˆï¼ˆå…¨ã¦å°æ–‡å­—ã«ã—ã¦æ¯”è¼ƒï¼‰
sorted(dic.items(), key=lambda x: str.lower(x[1]))
# => [('f', '1'), ('b', '12'), ('e', '2'), ('a', 'a'), ('c', 'A'), ('d', 'AA')]

# æ–‡å­—ã‚³ãƒ¼ãƒ‰ç¢ºèª
ord("0")
# => 48

ord("A")
# => 65

ord("a")
# => 97
```

## é€†é †ã«ã™ã‚‹

### `sorted`
`sorted`é–¢æ•°ã«`reverse=True`ã‚’æŒ‡å®šã—ã€ã‚¤ãƒ†ãƒ©ãƒ–ãƒ«ã‚’æ¸¡ã™ã¨ã€åˆ—æŒ™é †åºã‚’é€†ã«ã—ãŸ`list`ã‚’è¿”ã—ã¾ã™ã€‚

``` Python
dic = {"a": 0, "b": 1}

sorted(dic.keys(), reverse=True)
# => ['b', 'a']
```

### `reversed`
`reversed`é–¢æ•°ã«ã€ãƒªãƒãƒ¼ã‚·ãƒ–ãƒ«[^10000]ã‚’æ¸¡ã™ã¨ã€åˆ—æŒ™é †åºã‚’é€†ã«ã—ãŸã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã‚’è¿”ã—ã¾ã™ã€‚

ãŸã ã—ã€Python3.8æœªæº€ã§ã¯`dict`ãŠã‚ˆã³ã«ãƒ“ãƒ¥ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¯¾ã—ã¦`reversed`ã‚’ä½¿ç”¨ã§ãã¾ã›ã‚“[^4]ã€‚
ãã®å ´åˆã¯ã€`sorted`é–¢æ•°ã‹`OrderedDict`ã‚’åˆ©ç”¨ã—ã¦ãã ã•ã„ã€‚

``` Python
dic = {"a": 0, "b": 1}

list(reversed(dic.keys()))
# => ['b', 'a']
```

`reversed`ã¯ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã‚’è¿”ã™ãŸã‚ã€å®Ÿä½“åŒ–ã™ã‚‹ã«ã¯`list`ç­‰ã«ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã‚’æ¸¡ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

# ç‰¹æ®Šãªè¾æ›¸ç·¨

## åˆæœŸå€¤ã‚’ä¿æŒã—ãŸè¾æ›¸ã‚’ä½œæˆã™ã‚‹
åˆæœŸå€¤ä¿æŒã—ãŸ`dict`ã‚’ä½œæˆã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

ãŸã¨ãˆã°ã€å±¥æ­´æ›¸ã‚’æ¨¡ã—ãŸ`dict`ã«å®¶æ—æ§‹æˆã¨å­¦æ­´ã‚’ç™»éŒ²ã™ã‚‹ã¨ã—ã¾ã—ã‚‡ã†ã€‚
å®¶æ—æ§‹æˆã¨å­¦æ­´ã¯ã€ãƒªã‚¹ãƒˆã«ã„ãã¤ã‹å€¤ã‚’ç™»éŒ²ã™ã‚‹ã“ã¨ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã€‚

``` Python
person = {}
person["family"].append("father")  # => KeyError: 'family'
person["background"].append("2000/4/1 Pythoné«˜æ ¡å…¥å­¦")
person["background"].append("2003/4/1 Pythonå¤§å­¦å…¥å­¦")
```

ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã¯ã€2è¡Œç›®ã§ã‚¨ãƒ©ãƒ¼ã¨ãªã‚Šã¾ã—ãŸã€‚
`dict`åˆæœŸåŒ–æ™‚ã«ã€ãƒªã‚¹ãƒˆã‚’è¦ç´ ã¨ã—ã¦ç™»éŒ²ã—ã¦ã„ãªã„ã®ã§å½“ç„¶ã®çµæœã§ã™ã­ã€‚

ã“ã®ã‚ˆã†ãªå ´åˆã€`defaultdict`ã‚’ç”¨ã„ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚

### `defaultdict`
`defaultdict`ã¯ã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã™ã‚‹å¼•æ•°ãªã—ã§å®Ÿè¡Œã§ãã‚‹é–¢æ•°ã‚’æ¸¡ã™ã“ã¨ã§ã€ãã®é–¢æ•°ãŒè¿”ã—ãŸã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’åˆæœŸå€¤ã¨ã—ã¾ã™ã€‚

æ¬¡ã®ä¾‹ã¯ã€`list()`ã§ç”Ÿæˆã•ã‚Œã‚‹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’åˆæœŸå€¤ã¨ã—ã¦ã„ã¾ã™ã€‚

``` Python
from collections import defaultdict

# ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°ã‚’ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«æ¸¡ã—ã¾ã™
person = defaultdict(list)

person["family"].append("father")
person["background"].append("2000/4/1 Pythoné«˜æ ¡å…¥å­¦")
person["background"].append("2003/4/1 Pythonå¤§å­¦å…¥å­¦")
# => defaultdict(<class 'list'>, {'family': ['father'], 'background': ['2000/4/1 Pythoné«˜æ ¡å…¥å­¦', '2003/4/1 Pythonå¤§å­¦å…¥å­¦']})
```

intã‚„strã‚’æ¸¡ã™ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

``` Python
dic1 = defaultdict(int)
dic1["new"]
# => 0

dic2 = defaultdict(str)
dic2["new"]
# => ""
```

ã‚‚ã¡ã‚ã‚“ã€é–¢æ•°ã‚’æ¸¡ã™ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

``` Python
def create_list():
    return ["hello"]

dic1 = defaultdict(create_list)
dic1["new"]
# => ["hello"]
```


## æŒ¿å…¥é †ã‚’ä¿æŒã—ãŸè¾æ›¸ã‚’ä½œæˆã™ã‚‹

### `OrderedDict`
è¦ç´ ã®æŒ¿å…¥é †ã‚’ä¿æŒã—ãŸ`dict`ã‚’ä½œæˆã™ã‚‹ã«ã¯ã€`OrderedDict`ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

ãŸã ã—ã€Python3.7ä»¥é™ã¯æ¨™æº–ã®`dict`ã‚‚æŒ¿å…¥é †ã‚’ä¿æŒã™ã‚‹ã‚ˆã†ã«ãªã£ãŸã®ã§ã€`OrderedDict`ã¯ä½¿ã‚ãªã„ã§ã„ã„ã§ã—ã‚‡ã†[^1]ã€‚
``` Python
from collections import OrderedDict
dic = OrderedDict()

dic["key1"] = 0
dic["key2"] = 0

for item in dic.items():
  print(item)
# => ("key1", 0)
# => ("key2", 0)
```

:::message
- Python3.7æœªæº€ã§ã¯ã€è¾æ›¸ã®æŒ¿å…¥é †åºã‚’å–ã‚Šæ‰±ã†ãŸã‚ã«`OrderedDict`ã‚’ä½¿ç”¨ã™ã‚‹
:::

## è¦ç´ ã‚’é›†è¨ˆã—ãŸè¾æ›¸ã‚’ä½œæˆã™ã‚‹

### `Counter`
è¦ç´ ã‚’é›†è¨ˆã™ã‚‹ã«ã¯`Counter`ã¨ã„ã†ã‚¯ãƒ©ã‚¹ãŒåˆ©ç”¨ã§ãã¾ã™ã€‚

ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«ã€ã‚¤ãƒ†ãƒ©ãƒ–ãƒ«ã‚’æ¸¡ã™ã¨åŒã˜è¦ç´ ã®å€‹æ•°ã‚’é›†è¨ˆã§ãã¾ã™ã€‚

``` Python
from collections import Counter

data = ["tokyo", "osaka", "osaka"]
dic = Counter(data)
# => Counter({'osaka': 2, 'tokyo': 1})
```

æ–‡å­—åˆ—ã‚‚ã‚¤ãƒ†ãƒ©ãƒ–ãƒ«ãªãŸã‚é›†è¨ˆå¯èƒ½ã§ã™ã€‚

``` Python
from collections import Counter

data = "ã™ã‚‚ã‚‚ã‚‚ã‚‚ã‚‚ã‚‚ã‚‚ã‚‚ã®ã†ã¡"
dic = Counter(data)
# => Counter({'ã‚‚': 8, 'ã™': 1, 'ã®': 1, 'ã†': 1, 'ã¡': 1})
```

`dict`ã®åˆæœŸåŒ–ã¨åŒã˜ã‚ˆã†ã«ã€`Counter`ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã§ãã¾ã™ã€‚

``` Python
from collections import Counter

data = {"osaka": 1, "tokyo": 2}
dic = Counter(data)
# => Counter({'tokyo': 2, 'osaka': 1})

dic = Counter(osaka=1, tokyo=2))
# => Counter({'tokyo': 2, 'osaka': 1})
```

`Counter`ã¯ã€`dict`ã®ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã®ãŸã‚`dict`ã¨åŒã˜ã‚ˆã†ã«æ‰±ã†ã“ã¨ãŒã§ãã¾ã™ã€‚
ãŸã ã—ã€ã„ãã¤ã‹é›†è¨ˆç”¨ã«æ‹¡å¼µã•ã‚ŒãŸãƒ¡ã‚½ãƒƒãƒ‰ã‚„ç•°ãªã‚‹æŒ™å‹•ãŒå­˜åœ¨ã™ã‚‹ã®ã§ç´¹ä»‹ã—ã¾ã™ã€‚

### å€¤ã‚’å–å¾—ã™ã‚‹
`dict`ã¨åŒã˜ã‚ˆã†ã«ã‚­ãƒ¼ã‚’æŒ‡å®šã—ã€å€¤ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚
ã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ã€`dict`ã¨æŒ™å‹•ãŒç•°ãªã‚Š`0`ã‚’è¿”ã—ã¾ã™ã€‚

``` Python
from collections import Counter

data = ["tokyo", "osaka", "osaka"]
dic = Counter(data)
dic["chiba"]
# => 0
```

### `update`
`dict.update`ã¨åŒã˜ã‚ˆã†ã«ã€è¤‡æ•°ã®`dict`ã‚’ãƒãƒ¼ã‚¸ã§ãã¾ã™ã€‚
`dict`ã§ã¯ã€è¡çªã—ãŸã‚­ãƒ¼ã®å€¤ã‚’ä¸Šæ›¸ãã—ã¾ã™ãŒã€`Counter`ã«ãŠã„ã¦ã¯å€¤ã‚’åŠ ç®—ã—ã¾ã™ã€‚

``` Python
from collections import Counter

data = ["tokyo", "osaka", "osaka"]
dic = Counter(data)

dic.update({"tokyo": 2})
# => Counter({'tokyo': 3, 'osaka': 2})
```

### `subtract`
è¤‡æ•°ã®`dict`ã‚’ãƒãƒ¼ã‚¸ã—ã€è¡çªã—ãŸã‚­ãƒ¼ã®å€¤ã¯æ¸›ç®—ã—ã¾ã™ã€‚
`update`ã®é€†ã®æŒ™å‹•ã«ãªã‚Šã¾ã™ã€‚

``` Python
from collections import Counter

data = ["tokyo", "osaka", "osaka"]
dic = Counter(data)

dic.subtract({"tokyo": 2})
# => Counter({'osaka': 2, 'tokyo': -1})
```

### `most_common`
å€¤ã®é™é †ã§è¦ç´ ã‚’è¿”ã—ã¾ã™ã€‚
å¼•æ•°`n`ã‚’æŒ‡å®šã§ãã€nå€‹ã®è¦ç´ ã‚’è¿”ã™ã‹ã€çœç•¥ã¾ãŸã¯`None`ã®å ´åˆã¯ã™ã¹ã¦ã®è¦ç´ ãŒè¿”ã•ã‚Œã¾ã™ã€‚

``` Python
from collections import Counter

data = ["tokyo", "osaka", "osaka"]
dic = Counter(data)

for x in dic.most_common(1):
  print(x)
# => ('osaka', 2)

for x in dic.most_common():
  print(x)
# => ('osaka', 2)
# => ('tokyo', 1)
```

### `elements`
ãã‚Œãã‚Œã®å€¤ã¨åŒã˜å›æ•°ã‚­ãƒ¼ã‚’ç¹°ã‚Šè¿”ã™ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã‚’è¿”ã—ã¾ã™ã€‚è¦ç´ ãŒ1æœªæº€ã®å ´åˆã¯ã€ã‚­ãƒ¼ã¯è¿”ã•ã‚Œã¾ã›ã‚“ã€‚

``` Python
counter = Counter(a=4, b=2, c=0, d=-2)
sorted(counter.elements())
# => ['a', 'a', 'a', 'a', 'b', 'b']
```

## ä¸å¤‰ãªè¾æ›¸ã‚’ä½œæˆã™ã‚‹
ä¸å¤‰æ€§ã‚’ã‚‚ã¤ï¼ˆä½œæˆå¾Œã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®çŠ¶æ…‹ã‚’å¤‰ãˆã‚‹ã“ã¨ãŒã§ããªã„ï¼‰ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨å‘¼ã³ã¾ã™ã€‚
ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã†ã¾ãæ´»ç”¨ã™ã‚‹ã¨ã€äºˆæœŸã›ã¬ãƒ‡ãƒ¼ã‚¿ç ´å£Šã®ç”Ÿã˜ãªã„å …ç‰¢ãªãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãŒã§ãã¾ã™ã€‚

ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ãªã‚³ãƒ³ãƒ†ãƒŠå‹ã¯`tuple`ã‚„`frozenset`ãŒã‚ã‚Šã¾ã™ãŒã€è¾æ›¸ã«ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ãªå‹ã¯ãªã„ã®ã§ã€åˆ¥ã®æ–¹æ³•ã§ä»£æ›¿ã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

è¾æ›¸ã®ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«åŒ–ã«ã¤ã„ã¦ã€æ¬¡ã®PEPã§è­°è«–ã•ã‚Œã¦ã„ã¾ã™ã®ã§ã€èˆˆå‘³ãŒã‚ã‚Œã°ã”è¦§ãã ã•ã„ã€‚

- [PEP0416 frozendictã®å¦æ±º](https://www.python.org/dev/peps/pep-0416/)
- [PEP0603 frozenmapã®ææ¡ˆ](https://www.python.org/dev/peps/pep-0603/)

### MappingProxyType
`MappingProxyType`ã¯ã€èª­ã¿å‡ºã—å°‚ç”¨ã®å‹•çš„è¾æ›¸ãƒ“ãƒ¥ãƒ¼ã‚’æä¾›ã—ã¾ã™ã€‚

``` Python
from types import MappingProxyType

src = {"test": 1}
dic = MappingProxyType(src)

dic["test"]
# => 1

dic["test"] = 2
# => TypeError: 'mappingproxy' object does not support item assignment
```

ã‚½ãƒ¼ã‚¹è¾æ›¸ã‚’å¤‰æ›´ã™ã‚‹ã¨åŒæœŸçš„ã«å‹•ä½œã™ã‚‹ã®ã§ã€æœ¬å½“ã®æ„å‘³ã§ã®ä¸å¤‰ã¯ä¿è¨¼ã•ã‚Œã¾ã›ã‚“ãŒã€å¤šãã®ã‚±ãƒ¼ã‚¹ã§ååˆ†ã«è¦æ±‚ã‚’æº€ãŸã™ã§ã—ã‚‡ã†ã€‚

``` Python
from types import MappingProxyType

src = {"test": 1}
dic = MappingProxyType(src)

src["test"] = 2
dic["test"]
# => 2
```

### dataclass
Python3.7ã‹ã‚‰åˆ©ç”¨ã§ãã‚‹`dataclass`ã«`frozen=True`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹ã¨ã€ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ãªã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã§ãã¾ã™ã€‚

è¾æ›¸ã¨ã—ã¦æ‰±ã„ãŸã„å ´åˆã¯è¾æ›¸ã«å¤‰æ›ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

è¾æ›¸ã¸ã®å¤‰æ›æ–¹æ³•ã¯ã€[`dataclass`ã‚’è¾æ›¸ã«å¤‰æ›ã™ã‚‹](#dataclassã‚’è¾æ›¸ã«å¤‰æ›ã™ã‚‹)ã‚’å‚ç…§ãã ã•ã„ã€‚

``` Python
from dataclasses import dataclass

@dataclass(frozen=True)
class Person:
  name: str = "test"
  age: int = 20

obj = Person()

obj.name = "test"
# => dataclasses.FrozenInstanceError: cannot assign to field 'name'
```

### NamedTuple
`NamedTuple`ã¯`tuple`ã®ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã®ã‚ˆã†ã«ï¼ˆç”Ÿæˆã•ã‚ŒãŸã‚¯ãƒ©ã‚¹ã¯`NamedTuple`ã®ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã§ãªãã€`tuple`ã®ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã¨ãªã‚‹ï¼‰æŒ¯ã‚‹èˆã„ã€å„ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«å±æ€§åã‚’ä»˜ä¸ã§ãã¾ã™ã€‚
`tuple`ã¯ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ã§ã™ã®ã§ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®å¤‰æ›´ã¯è¨±å¯ã•ã‚Œã¾ã›ã‚“ã€‚

è¾æ›¸ã¨ã—ã¦æ‰±ã„ãŸã„å ´åˆã¯è¾æ›¸ã«å¤‰æ›ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

è¾æ›¸ã¸ã®å¤‰æ›æ–¹æ³•ã¯ã€[`NamedTuple`ã‚’è¾æ›¸ã«å¤‰æ›ã™ã‚‹](#NamedTupleã‚’è¾æ›¸ã«å¤‰æ›ã™ã‚‹)ã‚’å‚ç…§ãã ã•ã„ã€‚

``` Python
from typing import NamedTuple

class Person(NamedTuple):
  name: str = "test"
  age: int = 20

obj = Person()

obj.name
# => "test"

obj[0]
# => "test"

obj.name = ""
# => AttributeError: can't set attribute

obj["name"] = "test"
# => TypeError: 'Employee' object does not support item assignment
```

è¾æ›¸ã‹ã‚‰å‹•çš„ã«`NamedTuple`ç”Ÿæˆã‚‚ã§ãã¾ã™ãŒã€ã‚³ãƒ¼ãƒ‰ãŒç›´æ„Ÿçš„ã§ãªã„ã®ã§ã€ã‚ã¾ã‚Šä½¿ã†ã¹ãã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

``` Python
from collections import namedtuple
dic = {"name": "test", "age": 20}

Person = namedtuple('Person', dic.keys())  # ã‚¯ãƒ©ã‚¹ã‚’ç”Ÿæˆ
obj = Person(**dic)  # ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆ
# => Person(name='test', age=20)
```

### Pydantic
Pydanticã«ã¤ã„ã¦ã¯ã€‡ã€‡ã§ç´¹ä»‹ã—ã¾ã™ã®ã§ã€ã“ã“ã§ã¯ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ã«ã™ã‚‹ä¾‹ã®ã¿ç´¹ä»‹ã—ã¾ã™ã€‚

è¾æ›¸ã¨ã—ã¦æ‰±ã„ãŸã„å ´åˆã¯è¾æ›¸ã«å¤‰æ›ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

è¾æ›¸ã¸ã®å¤‰æ›æ–¹æ³•ã¯ã€[Pydanticã‚’è¾æ›¸ã«å¤‰æ›ã™ã‚‹](#Pydanticã‚’è¾æ›¸ã«å¤‰æ›ã™ã‚‹)ã‚’å‚ç…§ãã ã•ã„ã€‚

``` Python
from pydantic import BaseModel

class Person(BaseModel):
  name: str = "bob"
  age: int = 20
  class Config:
    allow_mutation = False  # å¤‰æ›´ã‚’è¨±å¯ã™ã‚‹ã‹å¦ã‹ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯True

obj = Person()
obj.name = "test"
# => TypeError: "Person" is immutable and does not support item assignment
```

### ä¸å¤‰ã«ãŠã‘ã‚‹æ³¨æ„ç‚¹
ç´¹ä»‹ã—ãŸã©ã®æ–¹æ³•ã‚‚ã€ãƒã‚¹ãƒˆã—ãŸè¾æ›¸ã«å¯¾ã™ã‚‹æ›¸ãè¾¼ã¿ã¯ç¦æ­¢ã§ãã¾ã›ã‚“ã€‚

``` Python
from types import MappingProxyType

src = {"nest": {}}
dic = MappingProxyType(src)

dic["nest"]["new"] = 1
dic
# => mappingproxy({'nest': {'new': 1}})
```

`list`ã‚„`set`ã®å ´åˆã‚‚åŒæ§˜ã§ã™ã€‚
å®Œå…¨ãªã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ã‚’ç›®æŒ‡ã™å ´åˆã¯ã€ãƒã‚¹ãƒˆã—ãŸãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’`MappingProxyType`ã€`tuple`ã€`frozenset`ç­‰ã«ç½®ãæ›ãˆã¾ã—ã‚‡ã†ã€‚

``` Python
from types import MappingProxyType

src = {"dict": MappingProxyType({}), "list": tuple(), "frozenset": frozenset()}
dic = MappingProxyType(src)

dic["dict"]["new"] = 1
# => TypeError: 'mappingproxy' object does not support item assignment

dic["list"].append(1)
# => AttributeError: 'tuple' object has no attribute 'append'

dic["frozenset"].add(1)
# => AttributeError: 'frozenset' object has no attribute 'add'
```

### ã©ã®æ–¹æ³•ã‚’ä½¿ã†ã¹ãã‹
åŸºæœ¬çš„ã«ã¯ã€`MappingProxyType`ã§ååˆ†ã§ã™ã€‚
å¾Œã¯ã€ã‚±ãƒ¼ã‚¹ã«å¿œã˜ã¦ä½¿ã„åˆ†ã‘ã¾ã—ã‚‡ã†ï¼ˆå¤§é‡ã«ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã™ã‚‹å¿…è¦ãŒãªã‘ã‚Œã°ã€ã©ã‚Œã‚‚å¤§å·®ã‚ã‚Šã¾ã›ã‚“ï¼‰ã€‚

- å˜ã«è¾æ›¸ã‚’èª­ã¿å–ã‚Šå°‚ç”¨ã«ã—ãŸã„ï¼š `MappingProxyType`
- IDEã«ã‚ˆã‚‹ã‚µãƒãƒ¼ãƒˆã¨æ¤œè¨¼æ©Ÿèƒ½ã‚’é‡è¦–ã—ãŸã„ï¼š Pydantic
- IDEã«ã‚ˆã‚‹ã‚µãƒãƒ¼ãƒˆã¨ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹é€Ÿåº¦ã‚’é‡è¦–ã—ãŸã„ï¼š `dataclass`
- IDEã«ã‚ˆã‚‹ã‚µãƒãƒ¼ãƒˆã¨ãƒ¡ãƒ¢ãƒªçœåŠ›åŒ–ã‚’é‡è¦–ã—ãŸã„ï¼š`NamedTuple`

æ¬¡ã®è¨˜äº‹ã‚‚å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚

- [Data Classes vs typing.NamedTuple primary use cases](https://stackoverflow.com/questions/51671699/data-classes-vs-typing-namedtuple-primary-use-cases)

# æ¤œè¨¼ç·¨
è¾æ›¸ã¯æ±ç”¨æ€§ãŒé«˜ã„ã§ã™ãŒã€ã©ã‚“ãªæ§‹é€ ã«ãªã£ã¦ã„ã‚‹ã‹ã€æƒ³å®šã—ãªã„å€¤ãŒæ··åœ¨ã—ã¦ã„ãªã„ã‹ãªã©ã€ã¨ãã©ããƒ‡ãƒ¼ã‚¿ã®ä¿¡é ¼æ€§ã«ç–‘å¿µã‚’ã‚‚ã¤æ™‚ãŒã‚ã‚Šã¾ã™ã€‚

ã“ã“ã§ã¯ã€è¾æ›¸ã®æ§‹é€ ã‚’å®šç¾©ã—ã€å …ç‰¢ãªãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’è¡Œã†æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

## TypedDict
Python3.8ã‹ã‚‰ã€TypedDictï¼ˆç‰¹å®šã®ã‚­ãƒ¼ã¨å‹ã‚’ã‚‚ã£ã¦ã„ã‚‹ã“ã¨ã‚’æœŸå¾…ã™ã‚‹è¾æ›¸ï¼‰ã‚’å®£è¨€ã§ãã¾ã™ã€‚
å®Ÿè¡Œæ™‚ã«å€¤ã®æ¤œè¨¼ã¯ã•ã‚Œã¾ã›ã‚“ãŒã€mypyãªã©ã®é™çš„è§£æãƒ„ãƒ¼ãƒ«ã§ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ™‚ã®èª¤ã‚Šã«æ°—ä»˜ã‘ã¾ã™ã€‚

``` Python
from typing import TypedDict

class Person(TypedDict):
  name: str
  age: int
```

ï¼ˆTODO: åŸ·ç­†ä¸­ï¼‰

## Pydantic
Pydanticã¯Python3.6ã‹ã‚‰å¯¾å¿œã—ã¦ã„ã‚‹ã€å …ç‰¢ãªãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’è¡Œã†ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚

Pydanticã¯ä¸»ã«æä¾›ã™ã‚‹æ©Ÿèƒ½ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚

- æ¤œè¨¼æ©Ÿèƒ½
- è¦ªåˆ‡ãªã‚¨ãƒ©ãƒ¼æƒ…å ±
- Pythonã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨JSONäº’æ›ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç›¸äº’å¤‰æ›
- OpenAPIç”Ÿæˆ

Python3.7ã‹ã‚‰å°å…¥ã•ã‚ŒãŸ`dataclass`ã¨ä¼¼ã¦ã„ã¾ã™ãŒã€Pydanticã§ã¯å‹ã‚’æ´»ç”¨ã—ãŸå¤šå½©ãªè¦æ±‚ã«å¯¾å¿œã§ãã¾ã™ã€‚

### å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
å°å…¥æ–¹æ³•ã‚„è©³ã—ã„åˆ©ç”¨æ–¹æ³•ã¯å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç­‰ã‚’å‚ç…§ãã ã•ã„ã€‚

https://pydantic-docs.helpmanual.io/

### è¾æ›¸ã®æ¤œè¨¼
åŸºæœ¬çš„ãªä½¿ã„æ–¹ã¯ã€`BaseModel`ã‚’ç¶™æ‰¿ã—ãŸã‚¯ãƒ©ã‚¹ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å‹ãƒ’ãƒ³ãƒˆã‚’ä»˜ä¸ã™ã‚‹ã¨ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç”Ÿæˆæ™‚ã«å€¤ã‚’æ¤œè¨¼ã—ã¾ã™ã€‚

``` Python
from datetime import datetime
from pydantic import BaseModel

class Person(BaseModel):
  name: str
  age: int
  birth_date: datetime = None

obj = Person(name="bob", age=20)
# => Person(name="bob", age=20, birth_date=None)

# ageã«æ•°å­—ä»¥å¤–ãŒæ··å…¥ã—ã¦ã„ã‚‹ã®ã§ã‚¨ãƒ©ãƒ¼
Person(name="bob", age="20æ­³")
# => ValidationError age value is not a valid integer

# å‹ãŒé•ã£ã¦ã„ã¦ã‚‚ã€è§£é‡ˆå¯èƒ½ãªã‚‰æ¤œè¨¼ã«æˆåŠŸã—ã€å‹å¤‰æ›ã‚’è¡Œã†ï¼ˆæ—¥ä»˜ã¯ISOå½¢å¼ã®æ–‡å­—åˆ—ã‚’è§£é‡ˆå¯èƒ½ï¼‰
obj = Person(name=1, age="20", birth_date="2020-1-1T00:00:00Z")
# => Person(name="1", age=20, datetime.datetime(2020, 1, 1, 0, 0, tzinfo=datetime.timezone.utc))
```

è¾æ›¸ã¨ã®ç›¸äº’å¤‰æ›ã¯éå¸¸ã«ç°¡å˜ã§ã™ã€‚
ãƒã‚¹ãƒˆã—ãŸæ§‹é€ ã‚‚è‹¦ã«ãªã‚Šã¾ã›ã‚“ã€‚

``` Python
import datetime
from typing import List
from pydantic import BaseModel

class Child(BaseModel):
  name: str
  birth_date: datetime.datetime

class Parent(BaseModel):
  name: str
  birth_date: datetime.datetime
  children: List[Child] = []

dic = {
    "name": "bob", "birth_date": datetime.datetime(2000,1,1),
    "children": [
        {"name": "tom", "birth_date": datetime.datetime(2018,1,1)},
        {"name": "mary", "birth_date": datetime.datetime(2020,1,1)}
    ]
}

obj = Parent(**dic)
# => Parent(name='bob', birth_date=datetime.datetime(2000, 1, 1, 0, 0), children=[Child(name='tom', birth_date=datetime.datetime(2018, 1, 1, 0, 0)), Child(name='mary', birth_date=datetime.datetime(2020, 1, 1, 0, 0))])

dic = obj.dict()
# => {'name': 'bob', 'birth_date': datetime.datetime(2000, 1, 1, 0, 0), 'children': [{'name': 'tom', 'birth_date': datetime.datetime(2018, 1, 1, 0, 0)}, {'name': 'mary', 'birth_date': datetime.datetime(2020, 1, 1, 0, 0)}]}
```

å¤šæ§˜ã™ã‚‹ã®ã¯å¥½ã¾ã—ããªã„ã§ã™ãŒã€Pydanticã§ã¯ã“ã‚“ãªãƒ©ãƒ•ãªã“ã¨ã‚‚ã§ãã¦ã—ã¾ã„ã¾ã™ã€‚

``` Python
from typing import Union
from pydantic import BaseModel, parse_obj_as

class Person1(BaseModel):
  name: str
  age: int

class Person2(BaseModel):
  fullname: str
  age: int

data = [
    {"fullname": "bob", "age": 20},
    {"name": "mary", "age": 18}
]

for row in data:
  print(parse_obj_as(Union[Person1, Person2], row))
  # => Person2(fullname='bob', age=20)
  # => Person1(name='mary', age=18)
```

å¾“æ¥ãªã‚‰ã€æ„šç›´ã«ifæ–‡ã§åˆ†å²å‡¦ç†ã‚’æ›¸ãã¨ã“ã‚ã§ã™ãŒã€`Union`ï¼ˆã„ãšã‚Œã‹ã®å‹ï¼‰ã‚’æŒ‡å®šã™ã‚‹ã¨ã€ã„ãšã‚Œã‹ã®å‹ã§è§£é‡ˆã™ã‚‹ã€ã¨ã„ã†æ›¸ãæ–¹ãŒã§ãã¾ã™ã€‚

é›‘ã«ãƒ‡ãƒ¼ã‚¿åˆ†æã—ãŸã„å ´é¢ã‚„ã€Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§å³å¯†ã«å®šç¾©ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã—ãŸã„å ´åˆãªã©ã€ã•ã¾ã–ã¾ãªçŠ¶æ³ã«å¿œã˜ãŸä½¿ã„æ–¹ãŒã§ãã¾ã™ã€‚


## ç’°å¢ƒå¤‰æ•°ã‚’æ¤œè¨¼ã™ã‚‹
è¾æ›¸çš„ã‚’ã‚‚ã¤ä»£è¡¨çš„ãªãƒªã‚½ãƒ¼ã‚¹ã®1ã¤ãŒç’°å¢ƒå¤‰æ•°ã§ã™ã€‚

```
os.environ["PATH"]
```

ï¼ˆTODO: åŸ·ç­†ä¸­ï¼‰

# å¤‰æ›ç·¨
ã‚ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¾æ›¸ã«å¤‰æ›ã™ã‚‹æ–¹æ³•ã‚„ã€è¾æ›¸ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€èˆ¬çš„ãªãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«å¤‰æ›ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

## `dataclass`ã‚’è¾æ›¸ã«å¤‰æ›ã™ã‚‹
`dataclass`ã¯ã€`asdict`é–¢æ•°ã§è¾æ›¸åŒ–ã§ãã¾ã™ã€‚

``` Python
from typing import List
from dataclasses import dataclass, asdict

@dataclass
class Child:
  name: str

@dataclass
class Parent:
  name: str
  children: List[Child]

obj = Parent(name="bob", children=[Child(name="tom"), Child(name="mary")])
asdict(obj)
# => {'name': 'bob', 'children': [{'name': 'tom'}, {'name': 'mary'}]}
```

`__dict__`ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€ãƒã‚¹ãƒˆã—ãŸ`dataclass`ã‚’å†å¸°çš„ã«è¾æ›¸åŒ–ã—ãªã„ãŸã‚åˆ©ç”¨ã—ã¦ã¯ã„ã‘ã¾ã›ã‚“ã€‚

``` Python
from typing import List
from dataclasses import dataclass, asdict

@dataclass
class Child:
  name: str

@dataclass
class Parent:
  name: str
  children: List[Child]

obj = Parent(name="bob", children=[Child(name="tom"), Child(name="mary")])
obj.__dict__
# => {'name': 'bob', 'children': [Child(name='tom'), Child(name='mary')]}
```

## `NamedTuple`ã‚’è¾æ›¸ã«å¤‰æ›ã™ã‚‹
`NamedTuple`ã¯ã€`_asdict`ãƒ¡ã‚½ãƒƒãƒ‰ã§è¾æ›¸åŒ–ã§ãã¾ã™ã€‚

``` Python
from typing import NamedTuple

class Person(NamedTuple):
  name: str

obj = Person(name="bob")
obj._asdict()
# => {'name': 'bob'}
```

ãªãŠã€`_asdict`ã¯å†å¸°çš„ãªè¾æ›¸åŒ–ã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚
ãƒã‚¹ãƒˆã•ã›ãªã„ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†ã€‚

``` Python
from typing import NamedTuple

class Child(NamedTuple):
  name: str

class Parent(NamedTuple):
  name: str
  children: List[Child]

obj = Parent(name="bob", children=[Child(name="tom"), Child(name="mary")])
obj._asdict()
# => {'name': 'bob', 'children': [Child(name='tom'), Child(name='mary')]}
```

## Pydanticã‚’è¾æ›¸ã«å¤‰æ›ã™ã‚‹
`pydantic.BaseModel`ã¯ã€`dict`ãƒ¡ã‚½ãƒƒãƒ‰ã§è¾æ›¸åŒ–ã§ãã¾ã™ã€‚

``` Python
from pydantic import BaseModel

class Child(BaseModel):
  name: str

class Parent(BaseModel):
  name: str
  children: List[Child]

obj = Parent(name="bob", children=[Child(name="tom"), Child(name="mary")])
obj.dict()
# => {'name': 'bob', 'children': [{'name': 'tom'}, {'name': 'mary'}]}
```

ã¾ãŸã€`include`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨`exclude`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ä»»æ„ã®å±æ€§ã®ã¿å‡ºåŠ›ãŒå¯èƒ½ã§ã™ã€‚

``` Python
from pydantic import BaseModel

class Person(BaseModel):
  name: str
  age: int
  sex: str

obj = Person(name="bob", age=20, sex="male")

obj.dict(include={"name"})
# => {'name': 'bob'}

obj.dict(exclude={"name"})
# => {'age': 20, 'sex': 'male'}
```

## è¾æ›¸ã¨JSONæ–‡å­—åˆ—ã‚’ç›¸äº’å¤‰æ›ã™ã‚‹

### `json`ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ã£ãŸã‚·ãƒªã‚¢ãƒ«åŒ–
Pythonæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®`json`ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’åˆ©ç”¨ã™ã‚‹ã¨ã€Pythonã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨JSONæ–‡å­—åˆ—ã®ç›¸äº’å¤‰æ›ãŒå¯èƒ½ã§ã™ã€‚

`json`ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã§åˆ©ç”¨å¯èƒ½ãªPythonã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯æ¬¡ã«ãªã‚Šã¾ã™ã€‚

- æ–‡å­—åˆ—å‹
- æ•°å€¤å‹
- `None`
- boolå‹
- è¾æ›¸å‹
- ãƒªã‚¹ãƒˆå‹

ã“ã“ã§ã¯ã€è¾æ›¸ãƒ‡ãƒ¼ã‚¿ã‚’JSONæ–‡å­—åˆ—ã«ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºï¼ˆã‚ã‚‹ç’°å¢ƒã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒã‚¤ãƒˆåˆ—ã‚„ç‰¹å®šã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«å¤‰æ›ã€‚ã‚·ãƒªã‚¢ãƒ«åŒ–ã¨ã‚‚å‘¼ã¶ï¼‰ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

``` Python
import json

dic = {"name": "test"}
json_str = json.dumps(dic)
# => '{"name": "test"}'
```

è¾æ›¸ã‚’JSONæ–‡å­—åˆ—ã«ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã—ãŸã‚‰ã€æ¬¡ã®ã‚ˆã†ã«ãƒ•ã‚¡ã‚¤ãƒ«ã¸æ›¸ãå‡ºã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

``` Python
json_str = '{"name": "test"}'

# ãƒ•ã‚¡ã‚¤ãƒ«ã¸æ›¸ãè¾¼ã‚€
with open("sample.json", mode="w") as f:
  f.write(json_str)
```

æ›¸ãå‡ºã—ãŸJSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€è¾æ›¸ã«ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºï¼ˆå¤–éƒ¨ãƒ‡ãƒ¼ã‚¿ã‚’ã‚ã‚‹ç’°å¢ƒã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦å¾©å…ƒã€‚é€†ã‚·ãƒªã‚¢ãƒ«åŒ–ã¨ã‚‚å‘¼ã¶ï¼‰ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

``` Python
import json

# ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€
with open("sample.json") as f:
  json_str = f.read(json_str)
  # => '{"name": "test"}'

dic = json.loads(json_str)
# => {"name": "test"}
```

ã“ã‚Œã§ã€è¾æ›¸ã¨JSONã‚’ç›¸äº’å¤‰æ›ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

## JSONæœªå¯¾å¿œãƒ‡ãƒ¼ã‚¿å‹ã‚’å«ã‚“ã è¾æ›¸ã¨JSONæ–‡å­—åˆ—ã‚’ç›¸äº’å¤‰æ›ã™ã‚‹
ä¾¿åˆ©ãª`json`ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã™ãŒã€ã™ã¹ã¦ã®å‹ã‚’JSONæ–‡å­—åˆ—ã¨ã—ã¦å‡ºåŠ›ã§ãã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

æ¬¡ã®ä¾‹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

``` Python
import datetime
import json
json.dumps({"date": datetime.datetime(2000,1,1)})
# => TypeError: Object of type 'datetime' is not JSON serializable
```

JSONã§åˆ©ç”¨å¯èƒ½ãªå‹ã«æ—¥ä»˜å‹ã¯å«ã¾ã‚Œãªã„ãŸã‚ã€ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã«å¤±æ•—ã—ã¦ã—ã¾ã„ã¾ã—ãŸã€‚
ã“ã®ã‚ˆã†ãªå ´åˆã¯ã€ç‹¬è‡ªã«å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

æ—¥ä»˜å‹ã®ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºå‡¦ç†ã¨ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºå‡¦ç†ã‚’è¡Œã£ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

``` Python
import datetime
import json

dic = {"date": datetime.datetime(2000,1,1)}

# æ—¥ä»˜å‹ã‚’æ–‡å­—åˆ—ã«ã—ã¦ã‹ã‚‰JSONæ–‡å­—åˆ—ã«ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã™ã‚‹
dic["date"] = datetime.datetime.isoformat(dic["date"])
json_str = json.dumps(dic)
# => '{"date": "2000-01-01T00:00:00"}'

# JSONæ–‡å­—åˆ—ã‚’è¾æ›¸ã«ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã—ã€æ–‡å­—åˆ—ã‚’æ—¥ä»˜å‹ã«æˆ»ã™
dic = json.loads(json_str)
dic["date"] = datetime.datetime.fromisoformat(dic["date"])
# => {'date': datetime.datetime(2000, 1, 1, 0, 0)}
```

`datetime`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯`isoformat`ãƒ¡ã‚½ãƒƒãƒ‰ã§ã€æ—¥ä»˜å‹ã‚’ISO 8601å½¢å¼ã®æ–‡å­—åˆ—ã«å¤‰æ›ã§ãã€`fromisoformat`ãƒ¡ã‚½ãƒƒãƒ‰ã§ISO 8601å½¢å¼ã®æ–‡å­—åˆ—ã‚’æ—¥ä»˜å‹ã«å¾©å…ƒã§ãã¾ã™ã€‚

ãŸã ã—ã€`fromisoformat`ãŒåˆ©ç”¨ã§ãã‚‹ã®ã¯ã€Python3.7ã‹ã‚‰ã§ã™ã€‚
Python3.7æœªæº€ã¯ã€åˆ¥ã®æ–¹æ³•ã§å‡¦ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

``` Python
import datetime

dic = {"date": "2000-01-01T00:00:00"}
dic["date"] = datetime.datetime.strptime(dic["date"], "%Y-%m-%dT%H:%M:%S")
# => {'date': datetime.datetime(2000, 1, 1, 0, 0)}
```

### Pydanticã‚’ä½¿ã£ãŸã‚·ãƒªã‚¢ãƒ«åŒ–
Pydanticã‚’ä½¿ã†ã¨ã€ç°¡æ½”ã§é«˜åº¦ãªã‚·ãƒªã‚¢ãƒ«åŒ–å‡¦ç†ãŒã§ãã¾ã™ã€‚

ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã¯æ¬¡ã®ã‚ˆã†ã«ã§ãã¾ã™ã€‚

``` Python
import json
from datetime import datetime
from pydantic import BaseModel

class Person(BaseModel):
  name: str
  birth_date: datetime

obj = Person(name="bob", birth_date=datetime(2000,1,1))
# => Person(name='bob', birth_date=datetime.datetime(2000, 1, 1, 0, 0))

json_str = obj.json()
# => '{"name": "bob", "birth_date": "2000-01-01T00:00:00"}'
```

ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã¯æ¬¡ã®ã‚ˆã†ã«ã§ãã¾ã™ã€‚

``` Python
import json
from datetime import datetime
from pydantic import BaseModel

class Person(BaseModel):
  name: str
  birth_date: datetime

json_str = '{"name": "bob", "birth_date": "2000-01-01T00:00:00"}'

dic = json.loads(json_str)
# => {'name': 'bob', 'birth_date': '2000-01-01T00:00:00'}
obj = Person(**dic)
# => Person(name='bob', birth_date=datetime.datetime(2000, 1, 1, 0, 0))

# ã¾ãŸã¯
obj = Person.parse_raw(json_str)
# => Person(name='bob', birth_date=datetime.datetime(2000, 1, 1, 0, 0))
```

æ–‡å­—åˆ—`"2000-01-01T00:00:00"`ã¯æ—¥ä»˜å‹`datetime.datetime(2000, 1, 1, 0, 0)`ã¨ã—ã¦ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã•ã‚Œã¦ã„ã¾ã™ã­ã€‚

`Person`ã‚¯ãƒ©ã‚¹ã®`birth_date`ã¯`datetime`ã¨å®šç¾©ã•ã‚Œã¦ã„ãŸã®ã§ã€PydanticãŒã‚ˆã—ãªã«ãƒ‡ãƒ¼ã‚¿è§£é‡ˆã‚’ã—ã¦ãã‚Œã¾ã—ãŸã€‚

# ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ
ã“ã‚Œã¾ã§ã®æ¤œè¨¼çµæœã‚’ã¾ã¨ã‚ã¾ã—ãŸã€‚ä¿¯ç°çš„ã«æŒ™å‹•ã‚’ç†è§£ã™ã‚‹ãŸã‚ã«ã”æ´»ç”¨ãã ã•ã„ã€‚

åŒã˜çµæœã‚’è¿”ã™è¤‡æ•°ã®å®Ÿç¾æ–¹æ³•ãŒã‚ã‚‹å ´åˆã¯ã€ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ãŒä¼ã‚ã‚Šã‚„ã™ã„æ–¹æ³•ã‚’ç”¨ã„ã¾ã—ã‚‡ã†ã€‚


| è¦æ±‚      | ã‚³ãƒ¼ãƒ‰ä¾‹ | å‚™è€ƒ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ |
| ---- | ---- | ---- | ---- |
| ä½œæˆ | `dic = {"key": "value"}` | `dict`é–¢æ•°ã«æ¯”ã¹æ€§èƒ½ãŒ2å€ä»¥ä¸Šå„ªã‚Œã‚‹ | |
| ä½œæˆ | `dic = dict(key="value")` | è¨€èªä»•æ§˜ä¸Šã€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ã«äºˆç´„èªã‚„æ•°å€¤ãƒªãƒ†ãƒ©ãƒ«ã¯ä½¿ç”¨ã§ããªã„ | |
| ä½œæˆ | `dic = dict([("key", "value")])` | ã‚­ãƒ¼ã¨å€¤ã®ã‚¿ãƒ—ãƒ«ã‹ã‚‰`dict`ã‚’ä½œæˆ | |
| ä½œæˆ | `dic = {key:value for key, value in [("key", "value")]}` |  | |
| ä½œæˆ | `dic = dict.fromkeys(["a", "b"], 0)` | ã‚­ãƒ¼ã®ãƒªã‚¹ãƒˆã‹ã‚‰`dict`ã‚’ç”Ÿæˆã™ã‚‹ã€‚ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ãªå€¤ã‚’åˆæœŸå€¤ï¼ˆç¬¬2å¼•æ•°ï¼‰ã¨ã™ã‚‹å ´åˆã«ã€å‰¯ä½œç”¨ãŒã‚ã‚‹ã€‚è¾æ›¸å†…åŒ…è¡¨è¨˜ã‚’ä½¿ãŠã† | |
| ç™»éŒ² | `dic["name"] = val` | `__setitem__`ã®ç³–è¡£æ§‹æ–‡ | |
| ç™»éŒ²/å–å¾— | `dic.setdefault("key")` | ã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã€`None`ã‚’ç™»éŒ²ã—ãŸã†ãˆã§ã€ã‚­ãƒ¼ã®å€¤ã‚’è¿”ã™ | |
| ç™»éŒ²/å–å¾— | `dic.setdefault("key", None)` | ã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã€ç¬¬2å¼•æ•°ã®å€¤ã‚’ç™»éŒ²ã—ãŸã†ãˆã§ã€ã‚­ãƒ¼ã®å€¤ã‚’è¿”ã™ | |
| å–å¾— | `dic["name"]` | ã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã€`KeyError`ãŒç™ºç”Ÿã€‚`__getitem__`ã®ç³–è¡£æ§‹æ–‡ | |
| å–å¾— | `dic.get("name")` | ã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã€`None`ã‚’è¿”ã™ | |
| å–å¾— | `dic.get("name", None)` | ã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã€ç¬¬2å¼•æ•°ã®å€¤ã‚’è¿”ã™ | |
| å‰Šé™¤ | `del dic["name"]` | ã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã€`KeyError`ãŒç™ºç”Ÿ | |
| å‰Šé™¤/å–å¾— | `dic.pop("name")` | ã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã€`KeyError`ãŒç™ºç”Ÿ | |
| å‰Šé™¤/å–å¾— | `dic.pop("a", None)` | ã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã€ç¬¬2å¼•æ•°ã®å€¤ã‚’è¿”ã™ | |
| å‰Šé™¤/å–å¾— | `dic.popitem()` | æœ€å¾Œã®è¦ç´ ã‚’å‰Šé™¤ã—ã€ã‚­ãƒ¼ã¨å€¤ã®ã‚¿ãƒ—ãƒ«ã‚’è¿”ã™[^1]ã€‚è¦ç´ ãŒç©ºã®å ´åˆã€`KeyError`ã¨ãªã‚‹ã€‚Python3.7æœªæº€ã¯ã€ç„¡ä½œç‚ºãªé †åºã§å‰Šé™¤ã™ã‚‹ | |
| ã‚­ãƒ¼å¤‰æ›´ | `dic["new"] = dic.pop("old")` | | |
| å…¨å‰Šé™¤ | `dic.clear()` | | |
| åˆ—æŒ™ | `for key in dic:` | `keys`ã‚’ä½¿ãŠã† | |
| åˆ—æŒ™ | `for key in dic.keys():` | ã‚­ãƒ¼ã‚’åˆ—æŒ™ã™ã‚‹ | |
| åˆ—æŒ™ | `for value in dic.values():` | å€¤ã‚’åˆ—æŒ™ã™ã‚‹ | |
| åˆ—æŒ™ | `for k, v in dic.items():` | ã‚­ãƒ¼ã¨å€¤ã®ã‚¿ãƒ—ãƒ«ã‚’åˆ—æŒ™ã™ã‚‹ | |
| åˆ—æŒ™ | `for k, v in dic.iteritems():` | Python3ã§`items`ã«çµ±åˆã•ã‚ŒãŸ[^3] | <=2.* |
| ã‚³ãƒ”ãƒ¼ | `dict(**dic)` | `copy`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ãŠã† | |
| ã‚³ãƒ”ãƒ¼ | `dict(dic)` | `copy`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ãŠã† | |
| ã‚³ãƒ”ãƒ¼ | `dic.copy()` | ã‚·ãƒ£ãƒ­ãƒ¼ã‚³ãƒ”ãƒ¼ã™ã‚‹ | |
| ã‚³ãƒ”ãƒ¼ | `copy.deepcopy(dic)` | ãƒ‡ã‚£ãƒ¼ãƒ—ã‚³ãƒ”ãƒ¼ã™ã‚‹ | |
| ãƒãƒ¼ã‚¸/ä½œæˆ | `dict(dic1, **dic2)` | å’Œé›†åˆæ¼”ç®—å­`|`ã‚’ä½¿ãŠã† | |
| ãƒãƒ¼ã‚¸/ä½œæˆ | `{**dic1, **dic2}` | å’Œé›†åˆæ¼”ç®—å­`|`ã‚’ä½¿ãŠã† | ^3.5 |
| ãƒãƒ¼ã‚¸/ä½œæˆ | `dic1 | dic2` | ã‚­ãƒ¼ãŒè¡çªã™ã‚‹å ´åˆã€å³è¾ºã®å€¤ã§ä¸Šæ›¸ã | ^3.9 |
| ãƒãƒ¼ã‚¸/æ›´æ–° | `dic1.update(dic2)` | ç´¯ç®—ä»£å…¥æ¼”ç®—å­`|=`ã‚’ä½¿ãŠã† |  |
| ãƒãƒ¼ã‚¸/æ›´æ–° | `dic1 |= dic2` | ã‚­ãƒ¼ãŒè¡çªã™ã‚‹å ´åˆã€å³è¾ºã®å€¤ã§ä¸Šæ›¸ã  | ^3.9 |
| ãƒãƒ¼ã‚¸/ä½œæˆ | `dict(key1=1, **dic2)` | ã‚­ãƒ¼ãŒè¡çªã™ã‚‹å ´åˆã€`TypeError`ãŒç™ºç”Ÿ |  |
| ãƒãƒ¼ã‚¸/ä½œæˆ | `dict(**dic1, **dic2)` | ã‚­ãƒ¼ãŒè¡çªã™ã‚‹å ´åˆã€`TypeError`ãŒç™ºç”Ÿ | ^3.5 |
| å•åˆ | `"a" in dic` | ã‚­ãƒ¼ã®å­˜åœ¨ã‚’ç¢ºèªã™ã‚‹ |  |
| å•åˆ | `"a" in dic.values()` | å€¤ã®å­˜åœ¨ã‚’ç¢ºèªã™ã‚‹ |  |
| å•åˆ | `dict(filter(lambda key_value: key_value[0] in cond, dic.items()))` | è©•ä¾¡é–¢æ•°ã«ä¸€è‡´ã™ã‚‹è¦ç´ ã‚’æŠ½å‡ºã™ã‚‹ã€‚ãªã‚‹ã¹ãè¾æ›¸å†…åŒ…è¡¨è¨˜ã‚’ä½¿ãŠã† |  |
| å•åˆ | `{key:value for key, value in dic.items() if key in cond}` |  |  |
| å•åˆ | `len(dic)` | è¦ç´ æ•°ã‚’å–å¾—ã™ã‚‹ |  |
| å•åˆ | `Counter(dic.values())` | ã‚¤ãƒ†ãƒ©ãƒ–ãƒ«ã®é›†è¨ˆçµæœï¼ˆåŒã˜è¦ç´ ã®å€‹æ•°ï¼‰ã‚’`dict`ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã«ã¾ã¨ã‚ã‚‹ |  |
| ã‚½ãƒ¼ãƒˆ | `sorted(dic.items())` | æ˜‡é †ã§ã‚½ãƒ¼ãƒˆã•ã‚ŒãŸãƒªã‚¹ãƒˆã‚’è¿”ã™ |  |
| ã‚½ãƒ¼ãƒˆ | `sorted(dic.items(), key=lambda x: x)` | ä»»æ„ã®è©•ä¾¡é–¢æ•°ã§ã‚½ãƒ¼ãƒˆã•ã‚ŒãŸãƒªã‚¹ãƒˆã‚’è¿”ã™ |  |
| ã‚½ãƒ¼ãƒˆ | `sorted(dic.items(), reverse=True)` | é€†é †ã«ã‚½ãƒ¼ãƒˆã•ã‚ŒãŸãƒªã‚¹ãƒˆã‚’è¿”ã™ |  |
| ã‚½ãƒ¼ãƒˆ | `reversed(dic.items())` | é€†é †ã«ã‚½ãƒ¼ãƒˆã™ã‚‹ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã‚’è¿”ã™ | ^3.7[^4] |
| åˆæœŸå€¤ä¿æŒ | `defaultdict(list)` | ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«æ¸¡ã—ãŸãƒ•ã‚¡ã‚¯ãƒˆãƒªé–¢æ•°ã®æˆ»ã‚Šå€¤ã‚’åˆæœŸå€¤ã¨ã™ã‚‹`dict`ã‚’ä½œæˆ | |
| æŒ¿å…¥é †ä¿æŒ | `OrderedDict()` | Python3.7ä»¥é™ã¯dictãŒ`OrderedDict`ç›¸å½“ã®é †åºã‚’ä¿æŒã™ã‚‹ã‚ˆã†ã«ãªã£ãŸãŸã‚ä¸è¦ | <=3.6.* |
| é›†è¨ˆ | `Counter(data)` | ã‚¤ãƒ†ãƒ©ãƒ–ãƒ«ã®é›†è¨ˆçµæœï¼ˆåŒã˜è¦ç´ ã®å€‹æ•°ï¼‰ã‚’`dict`ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã«ã¾ã¨ã‚ã‚‹ | |
| ä¸å¤‰ãªè¾æ›¸ | `types.MappingProxyType(dic)` | èª­ã¿å‡ºã—å°‚ç”¨ã®è¾æ›¸ãƒ“ãƒ¥ãƒ¼ã‚’æä¾›ã™ã‚‹ | ^3.3 |
| ä¸å¤‰ãªè¾æ›¸ | `@dataclasses.dataclass(frozen=True)` | ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ãª`dataclass`ã‚’è¾æ›¸ã«å¤‰æ›ã—ã¦åˆ©ç”¨ã§ãã‚‹ | ^3.7 |
| ä¸å¤‰ãªè¾æ›¸ | `class Dummy(typing.NamedTuple):` | ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ãª`NamedTuple`ã‚’è¾æ›¸ã«å¤‰æ›ã—ã¦åˆ©ç”¨ã§ãã‚‹ |  |
| ä¸å¤‰ãªè¾æ›¸ | `class Dummy(pydantic.BaseModel):` | `allow_mutation = False`ã§ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ã«æ‰±ã„ã€è¾æ›¸ã«å¤‰æ›ã—ã¦åˆ©ç”¨ã§ãã‚‹ | ^3.6 |
| æ¤œè¨¼ | `class Dummy(typing.TypedDict):` | å‹ãƒ’ãƒ³ãƒˆãŒåˆ©ç”¨ã§ãã‚‹è¾æ›¸ã€‚ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã§ã®æ¤œè¨¼ã¯ã—ãªã„ | ^3.8 |
| å¤‰æ› | `json.dumps(dic)` | Pythonã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰JSONæ–‡å­—åˆ—ã‚’å‡ºåŠ›ã™ã‚‹ | |
| å¤‰æ› | `json.loads(json_str)` | JSONæ–‡å­—åˆ—ã‹ã‚‰Pythonã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å¾©å…ƒã™ã‚‹ | |

# æœ€å¾Œã«
è‡ªåˆ†ã§ã¾ã¨ã‚ã¦ã„ã‚‹ã†ã¡ã«ã€ãªã‚“ã¨ãªãä½¿ã£ã¦ã„ãŸæ©Ÿèƒ½ã‚„çŸ¥ã‚‰ãªã‹ã£ãŸæ©Ÿèƒ½ã‚’ç™ºè¦‹ã§ãã¾ã—ãŸã€‚
Pythonã¯æ­´å²ãŒã‚ã‚Šã€ã„ã‚ã„ã‚ãªå®Ÿè£…æ–¹æ³•ãŒã‚ã£ãŸã‚Šã™ã‚‹ã®ã§ã€å°‘ã—ã¯æ··ä¹±ã‚’è§£æ¶ˆã§ããŸæ°—ãŒã—ã¾ã™ã€‚

# ã¤ã¶ã‚„ã
ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆã®å·¦åˆ—ãŒç‹­ã„ã€‚è¡¨ã®å¹…ã‚’æŒ‡å®šã§ããªã„ã‹ãªãã€‚


[^1]: [pep-0468](https://www.python.org/dev/peps/pep-0468/)ã«ã¦ã€Python3.7ã‚ˆã‚Š`dict`ã®è¦ç´ ã¯é †åºã‚’ä¿æŒã™ã‚‹ã‚ˆã†ã«ãªã£ãŸ
[^4]: [issue33462](https://bugs.python.org/issue33462)ã«ã¦ã€Python3.8ã‚ˆã‚Š`dict`ã¯ãƒªãƒãƒ¼ã‚·ãƒ–ãƒ«ã«ãªã£ãŸ
[^2]: [pep-0448](https://www.python.org/dev/peps/pep-0448/)ã«ã¦ã€Python3.5ã‚ˆã‚Šã‚¢ãƒ³ãƒ‘ãƒƒã‚¯è¨˜æ³•ãŒã‚ˆã‚Šæ±ç”¨çš„ã¨ãªã£ãŸ
[^3]: [pep-3106](https://www.python.org/dev/peps/pep-3106/)ã«ã¦ã€Python3ã‚ˆã‚Š`iteritems`ã¯`items`ã«çµ±åˆã•ã‚ŒãŸ
[^5]: [pep-0584](https://www.python.org/dev/peps/pep-0584/)ã«ã¦ã€Python3.9ã‚ˆã‚Šãƒãƒ¼ã‚¸ç”¨ã®æ¼”ç®—å­ãŒå®Ÿè£…ã•ã‚ŒãŸ

<!-- ç”¨èªé›† -->
[^10000]: ãƒªãƒãƒ¼ã‚·ãƒ–ãƒ«ï¼š `__reversed__`ã‚’ã‚‚ã¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
[^10001]: ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ï¼š `__iter__`ã¨`__next__`ã‚’ã‚‚ã¤åå¾©å¯èƒ½ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
[^10002]: ã‚¤ãƒ†ãƒ©ãƒ–ãƒ«ï¼š `__iter__`ã‚’ã‚‚ã¤åå¾©å¯èƒ½ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
